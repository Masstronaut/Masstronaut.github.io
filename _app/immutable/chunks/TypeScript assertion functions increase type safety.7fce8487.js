import{s as M,C as f,a5 as v,f as u,a as m,I as b,e as I,g as w,u as C,c as U,K as _,i as e,A as T,d as t}from"./scheduler.7131e7f1.js";import{S as O,i as q,b as Q,d as S,m as H,a as P,t as K,e as L}from"./index.9e889c2d.js";import{g as G,a as x}from"./spread.8a54911c.js";import{M as j}from"./MDSveXNoteLayout.c11df052.js";function R(y){let s,l='When working with union types, I often want to narrow the type to something specific. One way to do this is using <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#assertion-functions" rel="nofollow">assertion functions</a> which assert that after they’ve been invoked, I can be certain that the type is what was asserted. The following assertion function will assert that a user is an admin:',p,i,o=`<pre class="shiki shiki-themes vitesse-light vitesse-dark twoslash lsp" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]" data-tsplay="https://typescriptlang.org/play/#code/PTAEAEFMCdoe2gZwFygEwHYMFYBQkAPABwQBdRSBPIyUAVURlAF5QBvASwBNVFToOAOwDmAXwDc+YmQrVaAQS4BbIQyas10UADJ28ADaRUAIgCGyocYlSS0clRqgAcgiWn9mlvUZbdbA0agxgCuPlaSIKAAtDEAxsGkMVG4AGbBgrGkHHCCoKaIPqQAkoiKKoIAFKEwqC7Qbh4+oAA+oGWqPgCUqPmFiKDVWhz97YKebLgAkBwpFUHm5cagAITMrIMAdAGgnRQAFvAA7qCCkMcAorAIFSFNwydw5Ka5o8adkqK4kS5ZsbSke1opiuxzSGSyOVAiEoglIpgIoEB0EguFiOT4eQKMGKpQsgjQXiqPlqrncnlao003UxfQGdxGeM8zAAfOxcKBQDM5mY8UtVusfFs4IYdvsjiczqBLvBoDdBpz+oJHnkXrz3rhPql0plsrkFkIAPKCfSUIk1ZykxpMCmMroTDm9bElUZoM3QdWasE6yFcSCGUiQA3QYTPDgAL1MEMqg1QlJ8ABpQAgQ4Jw5HdUUeFD+EJhJ17aBIhtixrcFrwbq8qQA0oiKQACJ+yABoMptNRt0k+pkpo28qaRPJ0MRqOZ3g5kT5qaOuzOvFu9WTX3+wPB4fpnJuwdr1MjjNcReRDnHk+njkAPQA-BqgA"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> assertIsAdmin</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !==</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">role</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span></code></span>role</span></span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#1E754F;--shiki-dark:#4D9375"> throw</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Error</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorConstructor</span><br><span style="color:#AB5959;--shiki-dark:#CB7676">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">message</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#AB5959;--shiki-dark:#CB7676">undefined</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> options</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorOptions</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#AB5959;--shiki-dark:#CB7676">undefined</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#59873A;--shiki-dark:#80A665"> Error</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></code></span>Error</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user is not an Admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// Notice the arrow function syntax here</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#59873A;--shiki-dark:#80A665">assertIsAdmin2</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">) => asserts </span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin2</span></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#AB5959;--shiki-dark:#CB7676"> is </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !== </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">role</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B5695999;--shiki-dark:#C98A7D99"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span></code></span>role</span></span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#1E754F;--shiki-dark:#4D9375"> throw</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Error</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorConstructor</span><br><span style="color:#AB5959;--shiki-dark:#CB7676">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">message</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#AB5959;--shiki-dark:#CB7676">undefined</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> options</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorOptions</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#AB5959;--shiki-dark:#CB7676">undefined</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#59873A;--shiki-dark:#80A665"> Error</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></code></span>Error</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user is not an Admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> adminOnly</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>adminOnly</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">  </span><span class="twoslash-error"><span style="color:#59873A;--shiki-dark:#80A665">assertIsAdmin2</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span><div class="twoslash-meta-line twoslash-error-line">Assertions require every name in the call target to be declared with an explicit type annotation.</div><span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> deleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>deleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // ...</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> attemptDeleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>attemptDeleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><br><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695999;--shiki-dark:#C98A7D99">"</span><span style="color:#999999;--shiki-dark:#666666">;</span><br><span style="color:#999999;--shiki-dark:#666666">&#125;</span></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> assertIsAdmin</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> deleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>deleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover twoslash-query-presisted"><span class="twoslash-popup-container"><div class="twoslash-popup-arrow"></div><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre>`,n,k,z=`<pre class="code-copy-target hidden">// @errors: 2775
export type User = &#123;id: string&#125;;
export type AdminUser = User & &#123;role: "admin"&#125;;
export type NormalUser = User & &#123;role: "user"&#125;;
// ---cut---
function assertIsAdmin(user: NormalUser | AdminUser): asserts user is AdminUser &#123;
	if( "admin" !== user.role ) throw new Error("user is not an Admin");
&#125;
// Notice the arrow function syntax here
const assertIsAdmin2 = (user: NormalUser | AdminUser): asserts user is AdminUser =&gt; &#123;
  if( "admin" !== user.role ) throw new Error("user is not an Admin");
&#125;

function adminOnly(user: NormalUser | AdminUser)&#123;
  assertIsAdmin2(user);
&#125;

function deleteOrganization(user: AdminUser, organizationId: string)&#123;
  // ...
&#125;

function attemptDeleteOrganization(user: NormalUser | AdminUser, organizationId: string)&#123;
	assertIsAdmin(user);
	deleteOrganization(user, organizationId);
	//                 ^?
&#125;</pre>`,A,c,g="<code>assertIsAdmin</code> <em>asserts</em> that the <code>user</code> is an <code>AdminUser</code>. There are a couple things to note here:",B,d,E='<li>The <code>function</code> keyword is required. Notice that using <code>assertIsAdmin2</code>, the version with an arrow function, causes an error. This is because of an implementation detail of the compiler; <a href="https://github.com/microsoft/TypeScript/issues/56147#issuecomment-1768592995" rel="nofollow">the control flow graph is computed <em>before</em> type inferencing</a>.</li> <li>Any code that sits below a call to <code>assertIsAdmin</code> will have the type of <code>user</code> narrowed to <code>AdminUser</code>.</li>',D,h,F="In <code>attemptDeleteOrganization</code>, you can see that after the call to <code>assertIsAdmin</code>, the <code>user</code>’s type is narrowed to <code>AdminUser</code>.";return{c(){s=u("p"),s.innerHTML=l,p=m(),i=new b(!1),n=I(),k=new b(!1),A=m(),c=u("p"),c.innerHTML=g,B=m(),d=u("ol"),d.innerHTML=E,D=m(),h=u("p"),h.innerHTML=F,this.h()},l(a){s=w(a,"P",{"data-svelte-h":!0}),C(s)!=="svelte-1d5e8gd"&&(s.innerHTML=l),p=U(a),i=_(a,!1),n=I(),k=_(a,!1),A=U(a),c=w(a,"P",{"data-svelte-h":!0}),C(c)!=="svelte-1ju18a3"&&(c.innerHTML=g),B=U(a),d=w(a,"OL",{"data-svelte-h":!0}),C(d)!=="svelte-qpynp2"&&(d.innerHTML=E),D=U(a),h=w(a,"P",{"data-svelte-h":!0}),C(h)!=="svelte-yzj8hx"&&(h.innerHTML=F),this.h()},h(){i.a=n,k.a=A},m(a,r){e(a,s,r),e(a,p,r),i.m(o,a,r),e(a,n,r),k.m(z,a,r),e(a,A,r),e(a,c,r),e(a,B,r),e(a,d,r),e(a,D,r),e(a,h,r)},p:T,d(a){a&&(t(s),t(p),t(n),i.d(),k.d(),t(A),t(c),t(B),t(d),t(D),t(h))}}}function J(y){let s,l;const p=[y[0],N];let i={$$slots:{default:[R]},$$scope:{ctx:y}};for(let o=0;o<p.length;o+=1)i=f(i,p[o]);return s=new j({props:i}),{c(){Q(s.$$.fragment)},l(o){S(s.$$.fragment,o)},m(o,n){H(s,o,n),l=!0},p(o,[n]){const k=n&1?G(p,[n&1&&x(o[0]),n&0&&x(N)]):{};n&2&&(k.$$scope={dirty:n,ctx:o}),s.$set(k)},i(o){l||(P(s.$$.fragment,o),l=!0)},o(o){K(s.$$.fragment,o),l=!1},d(o){L(s,o)}}}const N={title:"TypeScript assertion functions increase type safety",description:"Assertion functions let the programmer narrow types using a named function, making type narrowing much more readable.",slug:"notes/assertion-functions",publish:!0,lastmod:"2024-02-16T00:00:00.000Z",date:"2024-02-16T00:00:00.000Z",aliases:null,tags:["status/seedling"],readTime:2,internalLinks:[],flashcards:[]};function $(y,s,l){return y.$$set=p=>{l(0,s=f(f({},s),v(p)))},s=v(s),[s]}class X extends O{constructor(s){super(),q(this,s,$,J,M,{})}}export{X as default,N as metadata};

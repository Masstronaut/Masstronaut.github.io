import"./Bzak7iHL.js";import"./DvJAWxb3.js";import{f as j,s,a as Q,T as t,b as i,V as o}from"./BxJAsQqh.js";import{h as a}from"./D9cADvLr.js";import{l as J,s as ss}from"./DRDuvXTo.js";import{M as as}from"./DDJvBvw7.js";import{H as r}from"./CDa9sNh6.js";import{H as p}from"./BU9hvMs3.js";const R={title:"Improving zsh startup times",description:"Applying my skills in performance optimization in a new domain: terminal (zsh) startup speed.",slug:"notes/zsh-startup",publish:!0,lastmod:"2025-02-02T00:00:00.000Z",date:"2025-01-31T00:00:00.000Z",aliases:null,tags:["status/budding"],readTime:13,internalLinks:["/notes/use-neovim"],flashcards:[]},{title:hs,description:ks,slug:Ms,publish:ms,lastmod:fs,date:ys,aliases:us,tags:gs,readTime:As,internalLinks:vs,flashcards:Ds}=R;var es=j('<p>I found an excellent article by Scott Spence on <a href="https://scottspence.com/posts/speeding-up-my-zsh-shell" rel="nofollow">Speeding up my zsh shell</a>. I‚Äôve been spending a lot more time in the terminal since <a href="/notes/use-neovim">switching to neovim</a> last Summer, and thought it was a good opportunity to improve my own zsh startup times.</p> <!> <p>To get started with any performance-related work, the first step is to do some profiling. Profiling is what tells me how long everything is taking, and whether optimizing a game engine, a frontend application, or a terminal emulator startup, profiling is <em>always</em> the first step!</p> <!> <p>It‚Äôs important to understand the <em>actual</em> time something takes. That makes it possible to understand when it is fast enough. ‚ÄúFast enough‚Äù depends on the context. For my zsh startup, I‚Äôll be happy with a time around 0.5-0.25 seconds.</p> <p>There‚Äôs often performance variability from one run to the next due to a variety of factors outside the actual code being profiled. Think of scenarios like the serverless cold start problem, running code that is vs isn‚Äôt in CPU cache, or starting an application from disk vs already loaded in memory. To get a better idea of how long something takes on average, it‚Äôs typical to run it multiple times to get a range of execution times and identify an average. I do this for zsh startup times with the following command:</p> <!><!> <p>Briefly what‚Äôs going on here is:</p> <ul><li><code>for i in ...</code> is a for loop that runs once for each value in a list, with <code>i</code> set to the current list item‚Äôs value</li> <li><code>$(seq 1 10)</code> uses the <code>seq</code> command to generate a list of numbers from 1-10 and captures the list as a value to be used by <code>for</code></li> <li><code>time</code> is a utility that times how long a command took to execute</li> <li><code>zsh -i</code> starts an interactive zsh session, ie one that can run commands</li> <li><code>-c</code> tells <code>zsh</code> to run the next argument (<code>exit</code>) as a command, rather than treating it as parameter to the current command</li></ul> <p>When I run this, I got a range from ~1.05-1.1 seconds:</p> <!><!> <p>So I‚Äôll need to shave off a bit more than 50% to get to the top end of my acceptable time of 0.5s. With that in mind, it‚Äôs go time!</p> <!> <p>Simply knowing how long my <code>zsh</code> startup takes and how fast I want it to be is insufficient. To know what needs optimizing, it‚Äôs important to <strong>profile the code</strong>. Profiling produces a detailed breakdown of how long each piece takes. Most technology stacks have some sort of performance profiling tool available for this reason.</p> <p>Zsh comes with a profiler, and it‚Äôs pretty easy to use. Crack open <code>.zshrc</code> and add two commands:</p> <!><!> <p>Save the file and start up a new zsh session (I do this by opening a new tab in WezTerm). After a slight delay, I see a printout of how long everything took:</p> <!><!> <p>Note: I‚Äôve truncated this list to exclude anything taking less than 1% of startup time, denoted by the <code>...</code></p> <p>This gives me a fairly detailed list of how long each item takes to run, sorted from the slowest to the fastest. This is great, because the slowest bits for me were at the bottom of my <code>.zshrc</code>. If I‚Äôd optimized that file from top to bottom I would‚Äôve done a ton of work with no impact!</p> <!> <p>There‚Äôs one obvious culprit behind my zsh startup times. Over 75% of the time is spent on various <code>nvm</code> tasks. Most of the time I am not even using <code>nvm</code>!</p> <p>This is great news since I only need a ~50% speed up to hit my performance target. I might be able to get away with an easy win and be done!</p> <!> <p>Here‚Äôs the offending <code>nvm</code> bits from near the bottom of my <code>.zshrc</code>:</p> <!><!> <p>I tried commenting out the line for completions and all the slowest bits were still there according to <code>zprof</code>, so it‚Äôs definitely loading <code>nvm</code> that‚Äôs slow. Commenting out the <code>nvm</code> loading code gets me down to ~0.55s startup time, so this is definitely a great place to start.</p> <p>I don‚Äôt use <code>nvm</code> much, which means two things to me:</p> <ol><li>it I‚Äôm okay with it starting slower instead of paying the load times on every shell startup. That makes it a perfect candidate for lazy loading!</li> <li>I‚Äôm not very familiar with its config or if it has built-in support for lazy-loading.</li></ol> <p>If it does, great! If it doesn‚Äôt, I‚Äôm going to have to DIY a solution. A quick search led me to Armno Prommarak‚Äôs article, aptly titled <a href="https://armno.in.th/blog/zsh-startup-time/" rel="nofollow">Lazy-load nvm to Reduce ZSH‚Äôs Startup Time</a>. Perfect! That‚Äôs exactly what I‚Äôm trying to do.</p> <!> <p>It seems that <code>nvm</code> doesn‚Äôt have lazy loading out of the box. Fortunately, there‚Äôs <a href="https://github.com/lukechilds/zsh-nvm" rel="nofollow">a zsh plugin that wraps nvm</a> with some extra features, including lazy loading!</p> <p>The obvious move here is to install the plugin, set it up, and be done. I <em>really</em> dislike repetitive and tedious tasks, and manually reinstalling dependencies is very boring for me. So instead, I‚Äôm going to set up my <code>.zshrc</code> to check if <code>zsh-nvm</code> is installed (very fast) and if it isn‚Äôt, install it. That way when I clone <a href="https://github.com/Masstronaut/dotfiles" rel="nofollow">my dotfiles repo</a> on another machine in the future, it‚Äôll automatically install <code>zsh-nvm</code> for me with no effort on my part. The way I‚Äôm going to do this is:</p> <ol><li>Check if <code>zsh-nvm</code> is installed <ol><li>if it‚Äôs not installed, install it via git</li></ol></li> <li>Set it to lazy-load <code>nvm</code></li> <li><code>source</code> the plugin code</li></ol> <p>Here‚Äôs what that looks like in code:</p> <!><!> <p>After a single .99s cold start, my remaining startups were ~.65s with this one change. Awesome! Shoutout to Luke Childs for making this great nvm plugin.</p> <p>Taking a look with <code>zprof</code> on, I get the following as my 3 slowest zsh startup steps:</p> <!><!> <p>Those are related to the completion system in zsh, so it looks like that‚Äôs up next!</p> <!> <p>Unlike with <code>nvm</code>, I‚Äôm always using commands when I open a new shell. Completions help me write commands faster and with better accuracy. I definitely want them every time I open my shell, so I can‚Äôt get away with lazy loading this time.</p> <p>Fortunately for me, Scott Spence also called out slow completion startups in their <a href="https://scottspence.com/posts/speeding-up-my-zsh-shell#fixing-the-completion-system-3076--10" rel="nofollow">zsh startup times blog post</a>. It was a quick fix too! The change is to only rebuild the completions cache if it doesn‚Äôt exist or is over 24h old, based on <a href="https://gist.github.com/ctechols/ca1035271ad134841284" rel="nofollow">this github gist</a>:</p> <!><!> <p>I found that this made almost 0 impact on my zsh startup time, so for me it‚Äôs probably not worth the added config complexity and the disabled security check.</p> <!> <p>I noticed a major omission from my <code>zprof</code> output - neofetch! Neofetch is a mostly useless tool; it prints out a pretty display with ASCII art of the OS logo and some system info. I have it run at the end of my <code>.zshrc</code>, and so its absence in <code>zprof</code> is peculiar. I‚Äôm not sure why it‚Äôs not in <code>zprof</code>, but was able to time it directly:</p> <!><!> <p>That is a substantial chunk of my ~.65s startup time. I went to check the <a href="https://github.com/dylanaraps/neofetch" rel="nofollow">neofetch repo</a> for any discussion about improving performance, and found the project has been archived. üò±</p> <p>Apparently the last release was in 2020! While it still works, I prefer not to run unmaintained software. The biggest reason is that unmaintained software likely still has vulnerabilities. If they are discovered and exploited, no software update will be released to fix it.</p> <p>Fortunately there are some maintained forks of neofetch! I found <a href="https://github.com/fastfetch-cli/fastfetch" rel="nofollow">fastfetch</a>, which is one written in C that has a focus on performance. I gave it a go with the following:</p> <!><!> <p>It grabs a bunch more data than my neofetch config does, and is configured via <code>jsonc</code>.  Importantly, it runs quite a bit faster:</p> <!><!> <p>That‚Äôs 3x faster than neofetch, and it‚Äôs grabbing more system info. With a bit of config tweaking, I‚Äôm sure I can get that down a little further. Strangely, after swapping it with <code>neofetch</code> in my <code>.zshrc</code>, <code>zprof</code> doesn‚Äôt show fastfetch as a line item either. If you know why these aren‚Äôt covered in zprof please let me know!</p> <p>Anyway I tried timing my zsh startups again and got great results:</p> <!><!> <p>It <em>feels</em> fast, and the numbers support that. Even with a cold start I‚Äôm under my 0.5s startup time target, and the typical startups are even faster than I was shooting for. Fantastic!</p> <!> <p>To get my shell starting fast again, I used zsh‚Äôs profiler and the <code>time</code> utility to figure out what was taking the longest time. By starting with the slowest pieces, I was able to hit my performance target in only a few changes:</p> <ol><li>Lazy-loading <code>nvm</code> only when I‚Äôm going to need node.js</li> <li>[Skipped] limit how often completions are rebuilt. I opted not to keep this change as the performance gain was minimal and not worth the added security risk</li> <li>Swapping out archived software, neofetch, for a faster and maintained replacement: fastfetch</li></ol> <p>I‚Äôll have to tinker with my fastfetch config to get the same output I had in neofetch. I‚Äôm glad I found that it was deprecated though. There‚Äôs one last step and this is a wrap:</p> <!><!> <p>ü´° So long, old friend!</p>',1);function bs(X,G){const K=J(G,["children","$$slots","$$events","$$legacy"]);as(X,ss(()=>K,()=>R,{children:(Z,ns)=>{var c=es(),d=s(Q(c),2);r(d,{id:"profiling-zsh-startup",children:(e,l)=>{o();var n=t("Profiling zsh startup");i(e,n)},$$slots:{default:!0}});var h=s(d,4);p(h,{id:"establish-a-baseline-startup-time",children:(e,l)=>{o();var n=t("Establish a baseline startup time");i(e,n)},$$slots:{default:!0}});var k=s(h,6);a(k,()=>'<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#B07D48;--shiki-dark:#BD976A"> i</span><span style="color:#1E754F;--shiki-dark:#4D9375"> in</span><span style="color:#999999;--shiki-dark:#666666"> $(</span><span style="color:#59873A;--shiki-dark:#80A665">seq</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 10</span><span style="color:#999999;--shiki-dark:#666666">);</span><span style="color:#1E754F;--shiki-dark:#4D9375"> do</span><span style="color:#59873A;--shiki-dark:#80A665"> /usr/bin/time</span><span style="color:#B56959;--shiki-dark:#C98A7D"> zsh</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -i</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -c</span><span style="color:#B56959;--shiki-dark:#C98A7D"> exit</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> done</span></span></code></pre>');var M=s(k);a(M,()=>'<pre class="code-copy-target hidden">for i in $(seq 1 10); do /usr/bin/time zsh -i -c exit; done</pre>');var m=s(M,8);a(m,()=>'<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span>1.06 real         0.56 user         0.46 sys</span></span></code></pre>');var f=s(m);a(f,()=>'<pre class="code-copy-target hidden">1.06 real         0.56 user         0.46 sys</pre>');var y=s(f,4);p(y,{id:"detailed-profiling",children:(e,l)=>{o();var n=t("detailed profiling");i(e,n)},$$slots:{default:!0}});var u=s(y,6);a(u,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" sh filename=".zshrc"><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Start the profiler at the top of the .zshrc</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">zmodload</span><span style="color:#B56959;--shiki-dark:#C98A7D"> zsh/zprof</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># all of my existing config in the middle....</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Finish the profiler and print the results</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">zprof</span></span></code></pre>`);var g=s(u);a(g,()=>`<pre class="code-copy-target hidden"># Start the profiler at the top of the .zshrc
zmodload zsh/zprof

# all of my existing config in the middle....
# ...

# Finish the profiler and print the results
zprof</pre>`);var A=s(g,4);a(A,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span>num  calls                time                       self            name</span></span>
<span class="line"><span>-----------------------------------------------------------------------------------</span></span>
<span class="line"><span> 1)    1         544.25   544.25   87.38%    263.45   263.45   42.30%  nvm_auto</span></span>
<span class="line"><span> 2)    2         254.65   127.32   40.89%    142.52    71.26   22.88%  nvm</span></span>
<span class="line"><span> 3)    1          88.13    88.13   14.15%     74.74    74.74   12.00%  nvm_ensure_version_installed</span></span>
<span class="line"><span> 4)    2          46.76    23.38    7.51%     46.76    23.38    7.51%  compaudit</span></span>
<span class="line"><span> 5)    1          22.84    22.84    3.67%     17.54    17.54    2.82%  nvm_die_on_prefix</span></span>
<span class="line"><span> 6)    1          61.34    61.34    9.85%     14.58    14.58    2.34%  compinit</span></span>
<span class="line"><span> 7)    1          13.39    13.39    2.15%     13.39    13.39    2.15%  nvm_is_version_installed</span></span>
<span class="line"><span> 8)    1          26.15    26.15    4.20%     11.59    11.59    1.86%  nvm_is_valid_version</span></span>
<span class="line"><span> 9)    1          12.21    12.21    1.96%      8.64     8.64    1.39%  nvm_validate_implicit_alias</span></span>
<span class="line"><span>10)    1           7.36     7.36    1.18%      7.28     7.28    1.17%  _zsh_highlight_load_highlighters</span></span>
<span class="line"><span>...</span></span></code></pre>`);var v=s(A);a(v,()=>`<pre class="code-copy-target hidden">num  calls                time                       self            name
-----------------------------------------------------------------------------------
 1)    1         544.25   544.25   87.38%    263.45   263.45   42.30%  nvm_auto
 2)    2         254.65   127.32   40.89%    142.52    71.26   22.88%  nvm
 3)    1          88.13    88.13   14.15%     74.74    74.74   12.00%  nvm_ensure_version_installed
 4)    2          46.76    23.38    7.51%     46.76    23.38    7.51%  compaudit
 5)    1          22.84    22.84    3.67%     17.54    17.54    2.82%  nvm_die_on_prefix
 6)    1          61.34    61.34    9.85%     14.58    14.58    2.34%  compinit
 7)    1          13.39    13.39    2.15%     13.39    13.39    2.15%  nvm_is_version_installed
 8)    1          26.15    26.15    4.20%     11.59    11.59    1.86%  nvm_is_valid_version
 9)    1          12.21    12.21    1.96%      8.64     8.64    1.39%  nvm_validate_implicit_alias
10)    1           7.36     7.36    1.18%      7.28     7.28    1.17%  _zsh_highlight_load_highlighters
...</pre>`);var D=s(v,6);r(D,{id:"optimize-the-slowest-stuff-first",children:(e,l)=>{o();var n=t("Optimize the slowest stuff first");i(e,n)},$$slots:{default:!0}});var b=s(D,6);p(b,{id:"identify-the-slowest-code",children:(e,l)=>{o();var n=t("Identify the slowest code");i(e,n)},$$slots:{default:!0}});var w=s(b,4);a(w,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" sh filename=".zshrc"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">export</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NVM_DIR</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$HOME/.nvm</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -s</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$NVM_DIR/nvm.sh</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ]</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;&#x26;</span><span style="color:#59873A;--shiki-dark:#80A665"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$NVM_DIR/nvm.sh</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">  # This loads nvm</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -s</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$NVM_DIR/bash_completion</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ]</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;&#x26;</span><span style="color:#59873A;--shiki-dark:#80A665"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$NVM_DIR/bash_completion</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">  # This loads nvm bash_completion</span></span></code></pre>`);var B=s(w);a(B,()=>`<pre class="code-copy-target hidden">export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && . "$NVM_DIR/bash_completion"  # This loads nvm bash_completion</pre>`);var z=s(B,10);p(z,{id:"lazy-loading-nvm-to-improve-zsh-startup-performance",children:(e,l)=>{o();var n=t("lazy-loading nvm to improve zsh startup performance");i(e,n)},$$slots:{default:!0}});var _=s(z,10);a(_,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" sh filename=".zshrc"><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Install zsh-nvm if it's not already installed</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">if</span><span style="color:#999999;--shiki-dark:#666666"> [[</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -f</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ~</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">/.zsh_plugins/zsh-nvm/zsh-nvm.plugin.zsh </span><span style="color:#999999;--shiki-dark:#666666">]];</span><span style="color:#1E754F;--shiki-dark:#4D9375"> then</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	git</span><span style="color:#B56959;--shiki-dark:#C98A7D"> clone</span><span style="color:#B56959;--shiki-dark:#C98A7D"> https://github.com/lukechilds/zsh-nvm.git</span><span style="color:#B56959;--shiki-dark:#C98A7D"> ~/.zsh_plugins/zsh-nvm</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Set the nvm</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">export</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NVM_DIR</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$HOME/.nvm</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Tell zsh-nvm to lazy-load nvm</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">export</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NVM_LAZY_LOAD</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B07D48;--shiki-dark:#BD976A">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># also load nvm when launching nvim</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Some web dev tooling depends on node</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">export</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NVM_LAZY_LOAD_EXTRA_COMMANDS</span><span style="color:#999999;--shiki-dark:#666666">=(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">nvim</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Tell zsh-nvm plugin to load nvm's bash completions</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">export</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NVM_COMPLETION</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B07D48;--shiki-dark:#BD976A">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># Load zsh-nvm</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">source</span><span style="color:#B56959;--shiki-dark:#C98A7D"> ~/.zsh_plugins/zsh-nvm/zsh-nvm.plugin.zsh</span></span></code></pre>`);var C=s(_);a(C,()=>`<pre class="code-copy-target hidden"># Install zsh-nvm if it's not already installed
if [[ ! -f ~/.zsh_plugins/zsh-nvm/zsh-nvm.plugin.zsh ]]; then
	git clone https://github.com/lukechilds/zsh-nvm.git ~/.zsh_plugins/zsh-nvm
fi

# Set the nvm
export NVM_DIR="$HOME/.nvm"

# Tell zsh-nvm to lazy-load nvm
export NVM_LAZY_LOAD=true

# also load nvm when launching nvim
# Some web dev tooling depends on node
export NVM_LAZY_LOAD_EXTRA_COMMANDS=('nvim')

# Tell zsh-nvm plugin to load nvm's bash completions
export NVM_COMPLETION=true

# Load zsh-nvm
source ~/.zsh_plugins/zsh-nvm/zsh-nvm.plugin.zsh</pre>`);var I=s(C,6);a(I,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span>num  calls                time                       self            name</span></span>
<span class="line"><span>-----------------------------------------------------------------------------------</span></span>
<span class="line"><span> 1)    1         372.07   372.07   89.50%    124.22   124.22   29.88%  compinit</span></span>
<span class="line"><span> 2)    1         115.43   115.43   27.76%    115.43   115.43   27.76%  compdump</span></span>
<span class="line"><span> 3)  811         107.50     0.13   25.86%    107.50     0.13   25.86%  compdef</span></span></code></pre>`);var x=s(I);a(x,()=>`<pre class="code-copy-target hidden">num  calls                time                       self            name
-----------------------------------------------------------------------------------
 1)    1         372.07   372.07   89.50%    124.22   124.22   29.88%  compinit
 2)    1         115.43   115.43   27.76%    115.43   115.43   27.76%  compdump
 3)  811         107.50     0.13   25.86%    107.50     0.13   25.86%  compdef</pre>`);var $=s(x,4);r($,{id:"speeding-up-zsh-completion-system-loading",children:(e,l)=>{o();var n=t("Speeding up zsh completion system loading");i(e,n)},$$slots:{default:!0}});var T=s($,6);a(T,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" zsh filename=".zshrc"><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># On slow systems, checking the cached .zcompdump file to see if it must be </span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># regenerated adds a noticable delay to zsh startup.  This little hack restricts </span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># it to once a day.  It should be pasted into your own completion file.</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">#</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># The globbing is a little complicated here:</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># - '#q' is an explicit glob qualifier that makes globbing work within zsh's [[ ]] construct.</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># - 'N' makes the glob pattern evaluate to nothing when it doesn't match (rather than throw a globbing error)</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># - '.' matches "regular files"</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># - 'mh+24' matches files (or directories or whatever) that are older than 24 hours.</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">autoload</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -Uz</span><span style="color:#B56959;--shiki-dark:#C98A7D"> compinit</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">if</span><span style="color:#999999;--shiki-dark:#666666"> [[</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -n</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ~</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">/.zcompdump</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">#</span><span style="color:#B07D48;--shiki-dark:#BD976A">qN</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">mh</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">24</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> ]];</span><span style="color:#1E754F;--shiki-dark:#4D9375"> then</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	compinit</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">else</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	compinit</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -C</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">fi</span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre>`);var F=s(T);a(F,()=>`<pre class="code-copy-target hidden"># On slow systems, checking the cached .zcompdump file to see if it must be 
# regenerated adds a noticable delay to zsh startup.  This little hack restricts 
# it to once a day.  It should be pasted into your own completion file.
#
# The globbing is a little complicated here:
# - '#q' is an explicit glob qualifier that makes globbing work within zsh's [[ ]] construct.
# - 'N' makes the glob pattern evaluate to nothing when it doesn't match (rather than throw a globbing error)
# - '.' matches "regular files"
# - 'mh+24' matches files (or directories or whatever) that are older than 24 hours.
autoload -Uz compinit 
if [[ -n ~/.zcompdump(#qN.mh+24) ]]; then
	compinit;
else
	compinit -C;
fi;</pre>`);var E=s(F,4);r(E,{id:"hidden-in-plain-sight",children:(e,l)=>{o();var n=t("Hidden in plain sight");i(e,n)},$$slots:{default:!0}});var S=s(E,4);a(S,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time /opt/homebrew/bin/neofetch</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#59873A;--shiki-dark:#80A665"> 2</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">></span><span style="color:#999999;--shiki-dark:#666666">&#x26;</span><span style="color:#59873A;--shiki-dark:#80A665">1</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">/opt/homebrew/bin/neofetch</span><span style="color:#B56959;--shiki-dark:#C98A7D">  0.28s</span><span style="color:#B56959;--shiki-dark:#C98A7D"> user</span><span style="color:#B56959;--shiki-dark:#C98A7D"> 0.26s</span><span style="color:#B56959;--shiki-dark:#C98A7D"> system</span><span style="color:#B56959;--shiki-dark:#C98A7D"> 86%</span><span style="color:#B56959;--shiki-dark:#C98A7D"> cpu</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 0.626</span><span style="color:#B56959;--shiki-dark:#C98A7D"> total</span></span></code></pre>`);var N=s(S);a(N,()=>`<pre class="code-copy-target hidden">(time /opt/homebrew/bin/neofetch) 2&gt;&1
/opt/homebrew/bin/neofetch  0.28s user 0.26s system 86% cpu 0.626 total</pre>`);var P=s(N,8);a(P,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#59873A;--shiki-dark:#80A665">brew</span><span style="color:#B56959;--shiki-dark:#C98A7D"> install</span><span style="color:#B56959;--shiki-dark:#C98A7D"> fastfetch</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">fastfetch</span></span></code></pre>`);var O=s(P);a(O,()=>`<pre class="code-copy-target hidden">brew install fastfetch
fastfetch</pre>`);var L=s(O,4);a(L,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span>(time /opt/homebrew/bin/neofetch) 2>&#x26;1</span></span>
<span class="line"><span>                    ..'          allan@Allans-MacBook-Pro</span></span>
<span class="line"><span>                 ,xNMM.           ------------------------</span></span>
<span class="line"><span>               .OMMMMo            OS: macOS Sequoia 15.2 arm64</span></span>
<span class="line"><span>               lMM"               Host: MacBook Pro (13-inch, M1, 2020)</span></span>
<span class="line"><span>     .;loddo:.  .olloddol;.       Kernel: Darwin 24.2.0</span></span>
<span class="line"><span>   cKMMMMMMMMMMNWMMMMMMMMMM0:     Uptime: 47 days, 5 hours, 22 mins</span></span>
<span class="line"><span> .KMMMMMMMMMMMMMMMMMMMMMMMWd.     Packages: 173 (brew), 11 (brew-cask)</span></span>
<span class="line"><span> XMMMMMMMMMMMMMMMMMMMMMMMX.       Shell: zsh 5.9</span></span>
<span class="line"><span>;MMMMMMMMMMMMMMMMMMMMMMMM:        Display (Color LCD): 1920x1200 @ 60 Hz in 13" [Built-in]</span></span>
<span class="line"><span>:MMMMMMMMMMMMMMMMMMMMMMMM:        DE: Aqua</span></span>
<span class="line"><span>.MMMMMMMMMMMMMMMMMMMMMMMMX.       WM: Quartz Compositor 278.2.7</span></span>
<span class="line"><span> kMMMMMMMMMMMMMMMMMMMMMMMMWd.     WM Theme: Pink (Dark)</span></span>
<span class="line"><span> 'XMMMMMMMMMMMMMMMMMMMMMMMMMMk    Font: .AppleSystemUIFont [System], Helvetica [User]</span></span>
<span class="line"><span>  'XMMMMMMMMMMMMMMMMMMMMMMMMK.    Cursor: Fill - Black, Outline - White (32px)</span></span>
<span class="line"><span>    kMMMMMMMMMMMMMMMMMMMMMMd      Terminal: WezTerm 20240203-110809-5046fc22</span></span>
<span class="line"><span>     ;KMMMMMMMWXXWMMMMMMMk.       Terminal Font: Hack Nerd Font</span></span>
<span class="line"><span>       "cooc*"    "*coo'"         CPU: Apple M1 (8) @ 3.20 GHz</span></span>
<span class="line"><span>                                  GPU: Apple M1 (8) [Integrated]</span></span>
<span class="line"><span>                                  Memory: 12.48 GiB / 16.00 GiB (78%)</span></span>
<span class="line"><span>                                  Swap: 5.51 GiB / 7.00 GiB (79%)</span></span>
<span class="line"><span>                                  Disk (/): 612.69 GiB / 926.35 GiB (66%) - apfs [Read-only]</span></span>
<span class="line"><span>                                  Local IP (en0): ***.***.***.***</span></span>
<span class="line"><span>                                  Battery (bq20z451): 100% (13 hours, 13 mins remaining) [Discharging]</span></span>
<span class="line"><span>                                  Locale: en_US.UTF-8</span></span>
<span class="line"><span>/opt/homebrew/bin/fastfetch  0.09s user 0.07s system 49% cpu 0.325 total</span></span></code></pre>`);var W=s(L);a(W,()=>`<pre class="code-copy-target hidden">(time /opt/homebrew/bin/neofetch) 2&gt;&1
                    ..'          allan@Allans-MacBook-Pro
                 ,xNMM.           ------------------------
               .OMMMMo            OS: macOS Sequoia 15.2 arm64
               lMM"               Host: MacBook Pro (13-inch, M1, 2020)
     .;loddo:.  .olloddol;.       Kernel: Darwin 24.2.0
   cKMMMMMMMMMMNWMMMMMMMMMM0:     Uptime: 47 days, 5 hours, 22 mins
 .KMMMMMMMMMMMMMMMMMMMMMMMWd.     Packages: 173 (brew), 11 (brew-cask)
 XMMMMMMMMMMMMMMMMMMMMMMMX.       Shell: zsh 5.9
;MMMMMMMMMMMMMMMMMMMMMMMM:        Display (Color LCD): 1920x1200 @ 60 Hz in 13" [Built-in]
:MMMMMMMMMMMMMMMMMMMMMMMM:        DE: Aqua
.MMMMMMMMMMMMMMMMMMMMMMMMX.       WM: Quartz Compositor 278.2.7
 kMMMMMMMMMMMMMMMMMMMMMMMMWd.     WM Theme: Pink (Dark)
 'XMMMMMMMMMMMMMMMMMMMMMMMMMMk    Font: .AppleSystemUIFont [System], Helvetica [User]
  'XMMMMMMMMMMMMMMMMMMMMMMMMK.    Cursor: Fill - Black, Outline - White (32px)
    kMMMMMMMMMMMMMMMMMMMMMMd      Terminal: WezTerm 20240203-110809-5046fc22
     ;KMMMMMMMWXXWMMMMMMMk.       Terminal Font: Hack Nerd Font
       "cooc*"    "*coo'"         CPU: Apple M1 (8) @ 3.20 GHz
                                  GPU: Apple M1 (8) [Integrated]
                                  Memory: 12.48 GiB / 16.00 GiB (78%)
                                  Swap: 5.51 GiB / 7.00 GiB (79%)
                                  Disk (/): 612.69 GiB / 926.35 GiB (66%) - apfs [Read-only]
                                  Local IP (en0): ***.***.***.***
                                  Battery (bq20z451): 100% (13 hours, 13 mins remaining) [Discharging]
                                  Locale: en_US.UTF-8
/opt/homebrew/bin/fastfetch  0.09s user 0.07s system 49% cpu 0.325 total</pre>`);var H=s(W,6);a(H,()=>`<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#B07D48;--shiki-dark:#BD976A"> i</span><span style="color:#1E754F;--shiki-dark:#4D9375"> in</span><span style="color:#999999;--shiki-dark:#666666"> $(</span><span style="color:#59873A;--shiki-dark:#80A665">seq</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 10</span><span style="color:#999999;--shiki-dark:#666666">);</span><span style="color:#1E754F;--shiki-dark:#4D9375"> do</span><span style="color:#59873A;--shiki-dark:#80A665"> /usr/bin/time</span><span style="color:#B56959;--shiki-dark:#C98A7D"> zsh</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -i</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -c</span><span style="color:#B56959;--shiki-dark:#C98A7D"> exit</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> done</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">0.45</span><span style="color:#B56959;--shiki-dark:#C98A7D"> real</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.25</span><span style="color:#B56959;--shiki-dark:#C98A7D"> user</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.16</span><span style="color:#B56959;--shiki-dark:#C98A7D"> sys</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">0.18</span><span style="color:#B56959;--shiki-dark:#C98A7D"> real</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.08</span><span style="color:#B56959;--shiki-dark:#C98A7D"> user</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.06</span><span style="color:#B56959;--shiki-dark:#C98A7D"> sys</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">0.18</span><span style="color:#B56959;--shiki-dark:#C98A7D"> real</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.08</span><span style="color:#B56959;--shiki-dark:#C98A7D"> user</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.06</span><span style="color:#B56959;--shiki-dark:#C98A7D"> sys</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">0.17</span><span style="color:#B56959;--shiki-dark:#C98A7D"> real</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.08</span><span style="color:#B56959;--shiki-dark:#C98A7D"> user</span><span style="color:#2F798A;--shiki-dark:#4C9A91">         0.06</span><span style="color:#B56959;--shiki-dark:#C98A7D"> sys</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">...</span></span></code></pre>`);var q=s(H);a(q,()=>`<pre class="code-copy-target hidden">for i in $(seq 1 10); do /usr/bin/time zsh -i -c exit; done
0.45 real         0.25 user         0.16 sys
0.18 real         0.08 user         0.06 sys
0.18 real         0.08 user         0.06 sys
0.17 real         0.08 user         0.06 sys
...</pre>`);var V=s(q,4);r(V,{id:"conclusion",children:(e,l)=>{o();var n=t("Conclusion");i(e,n)},$$slots:{default:!0}});var U=s(V,8);a(U,()=>'<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#59873A;--shiki-dark:#80A665">brew</span><span style="color:#B56959;--shiki-dark:#C98A7D"> uninstall</span><span style="color:#B56959;--shiki-dark:#C98A7D"> neofetch</span></span></code></pre>');var Y=s(U);a(Y,()=>'<pre class="code-copy-target hidden">brew uninstall neofetch</pre>'),o(2),i(Z,c)},$$slots:{default:!0}}))}export{bs as default,R as metadata};

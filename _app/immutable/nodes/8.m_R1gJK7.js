import{d as M,a as _,t as J}from"../chunks/QqLkXUPV.js";import{f as z,p as K,c as U,s as X,a as Z,M as f,am as N,a7 as P,$ as p,r as tt}from"../chunks/_9pnLWT9.js";import{d as et,e as at}from"../chunks/W8aj68s9.js";import{i as Y}from"../chunks/B-eN9XNX.js";import{b as st}from"../chunks/1IPPVSMY.js";import"../chunks/DZxdjYg5.js";import{s as V}from"../chunks/ChGUch2R.js";import{l as O,s as q}from"../chunks/AsWAPDv1.js";import{I as E}from"../chunks/RHwXm69u.js";function ot(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"play"},()=>a,{iconNode:[["polygon",{points:"6 3 20 12 6 21 6 3"}]],children:(r,c)=>{var l=M(),i=z(l);V(i,s,"default",{},null),_(r,l)},$$slots:{default:!0}}))}function it(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"volume-2"},()=>a,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["path",{d:"M16 9a5 5 0 0 1 0 6"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728"}]],children:(r,c)=>{var l=M(),i=z(l);V(i,s,"default",{},null),_(r,l)},$$slots:{default:!0}}))}function nt(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"volume-x"},()=>a,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15"}]],children:(r,c)=>{var l=M(),i=z(l);V(i,s,"default",{},null),_(r,l)},$$slots:{default:!0}}))}function lt({pen:t},{radius:s,center:a,hsl:n}){t.lineCap="butt",t.lineWidth=1,t.strokeStyle=`hsla(${n}, 1)`,t.shadowColor=`hsla(${n}, 1)`,t.shadowBlur=10,t.beginPath(),t.arc(a.x,a.y,s,Math.PI,2*Math.PI),t.stroke(),t.shadowBlur=5,t.lineWidth=2,t.strokeStyle=`hsla(${n}, 0.3)`,t.shadowOffsetY=2.5,t.stroke(),t.strokeStyle=`hsla(${n}, 0.2)`,t.stroke(),t.strokeStyle=`hsla(${n}, 0.1)`,t.stroke(),t.shadowOffsetY=-2.5,t.stroke(),t.strokeStyle=`hsla(${n}, 0.2)`,t.stroke(),t.strokeStyle=`hsla(${n}, 0.3)`,t.stroke()}function rt(t,{arc:s,angle:a}){const n={x:s.center.x+Math.cos(a)*s.radius,y:s.center.y+Math.sin(a)*s.radius};t.beginPath(),t.arc(n.x,n.y,5,0,2*Math.PI),t.stroke(),t.stroke()}let h;function ct(t,{unisonWidth:s,durationSeconds:a}={unisonWidth:1,durationSeconds:1}){[-s,0,s].map(r=>{h||(h=new AudioContext);const c=h.createOscillator(),l=h.createGain();l.gain.value=.2,c.connect(l);const i=h.createGain();i.gain.cancelScheduledValues(h.currentTime),l.connect(i),c.type="sine",c.frequency.value=t,c.detune.value=r;const m={attack:0,decay:.05,sustain:{duration:0,intensity:.8},release:.4},g=h.currentTime,w=m.attack*a,x=g+w,v=m.decay*a;i.gain.setValueAtTime(0,g),i.gain.linearRampToValueAtTime(1,x),i.gain.setTargetAtTime(m.sustain.intensity,x,v);const y=x+v+m.sustain.duration*a,C=m.release*a;i.gain.setValueAtTime(m.sustain.intensity,y);const F=y+C;i.gain.linearRampToValueAtTime(0,F);const I=h.sampleRate/2,e=h.createBiquadFilter();return e.type="lowpass",e.frequency.value=.2*I,e.Q.value=23.1,i.connect(e),e.connect(h.destination),c}).forEach(r=>{r.start()})}var dt=J('<div class="relative"><canvas class="relative h-[80dvh] w-full bg-black"></canvas> <!></div>');function xt(t,s){K(s,!0);let a=N(void 0),n=null,r,c=N(!0);const l=[261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88];let i=l.map((e,o,$)=>{const u=2*Math.PI*(50-2*o),d=15*60,b=u/d;return{color:`${o*(360/$.length)},100%, 50%`,tone:l[o],velocity:b,lastImpact:0,nextImpactTime:0}});const m=(e,o)=>e+Math.PI/o*1e3;let g=N(!1);function w({pen:e,paper:o}){r||(r=new Date().getTime(),i.forEach(k=>{k.lastImpact=k.nextImpactTime=r}));const $=new Date().getTime(),T=($-r)/1e3;o.width=o.clientWidth,o.height=o.clientHeight;const u=[{x:o.width*.1,y:o.height*.9},{x:o.width*.9,y:o.height*.9}];e.strokeStyle="#FFFFFF66",e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(u[0].x,u[0].y),e.lineTo(u[1].x,u[1].y),e.stroke();const d=u[1].x-u[0].x,b=.05*d,G=(d/2-b)/(i.length-1),W={x:o.width*.5,y:o.height*.9};i=i.map(({color:k,velocity:S,tone:B,lastImpact:R,nextImpactTime:A},Q)=>{const H=b+Q*G;lt({pen:e},{radius:H,center:W,hsl:k}),e.lineWidth=2,e.strokeStyle=`hsla(${k}, 1)`,e.shadowBlur=8,e.shadowOffsetY=0;const L=2*Math.PI,D=(Math.PI+T*S)%L,j=D>=Math.PI?D:L-D;return rt(e,{arc:{radius:H,center:W},angle:j}),$>A&&(f(c)&&ct(B),R=A,A=m(R,S)),{color:k,tone:B,nextImpactTime:A,lastImpact:R,velocity:S}}),requestAnimationFrame(()=>w({paper:o,pen:e}))}function x(){f(g)?P(c,!f(c)):(n=f(a).getContext("2d"),w({paper:f(a),pen:n}),P(g,!0))}var v=dt();at("visibilitychange",p,()=>{console.log("disabling sound"),P(c,!1)});var y=U(v);y.__click=x,st(y,e=>P(a,e),()=>f(a));var C=X(y,2);{var F=e=>{ot(e,{class:" pointer-events-none absolute left-1/2 top-1/2 size-16 -translate-x-1/2 -translate-y-1/2 transform stroke-gray-300/80 stroke-2"})},I=e=>{var o=M(),$=z(o);{var T=d=>{it(d,{class:"absolute right-2 top-2 z-10 size-6 stroke-gray-400"})},u=d=>{nt(d,{class:"absolute right-2 top-2 z-10 size-6 stroke-gray-400"})};Y($,d=>{f(c)?d(T):d(u,!1)},!0)}_(e,o)};Y(C,e=>{f(g)?e(I,!1):e(F)})}tt(v),_(t,v),Z()}et(["click"]);export{xt as component};

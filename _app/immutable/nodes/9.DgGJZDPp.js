import{d as D,a as P,t as J}from"../chunks/DxLz9yiU.js";import{f as N,p as K,az as R,c as U,s as X,a as Z,g as m,a3 as A,$ as p,r as tt}from"../chunks/DOUKym4R.js";import{d as et,j as at}from"../chunks/CIG4rBk-.js";import{i as Y}from"../chunks/CUWbJkzy.js";import{b as st}from"../chunks/DFp6T6Ul.js";import"../chunks/DYy8QdnN.js";import{s as V}from"../chunks/Ce_vlHue.js";import{l as O,s as q}from"../chunks/CpBMUuGS.js";import{I as E}from"../chunks/BDpxQy9M.js";function ot(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"play"},()=>a,{iconNode:[["polygon",{points:"6 3 20 12 6 21 6 3"}]],children:(c,d)=>{var l=D(),o=N(l);V(o,s,"default",{},null),P(c,l)},$$slots:{default:!0}}))}function it(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"volume-2"},()=>a,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["path",{d:"M16 9a5 5 0 0 1 0 6"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728"}]],children:(c,d)=>{var l=D(),o=N(l);V(o,s,"default",{},null),P(c,l)},$$slots:{default:!0}}))}function nt(t,s){const a=O(s,["children","$$slots","$$events","$$legacy"]);E(t,q({name:"volume-x"},()=>a,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15"}]],children:(c,d)=>{var l=D(),o=N(l);V(o,s,"default",{},null),P(c,l)},$$slots:{default:!0}}))}function lt({pen:t},{radius:s,center:a,hsl:n}){t.lineCap="butt",t.lineWidth=1,t.strokeStyle=`hsla(${n}, 1)`,t.shadowColor=`hsla(${n}, 1)`,t.shadowBlur=10,t.beginPath(),t.arc(a.x,a.y,s,Math.PI,2*Math.PI),t.stroke(),t.shadowBlur=5,t.lineWidth=2,t.strokeStyle=`hsla(${n}, 0.3)`,t.shadowOffsetY=2.5,t.stroke(),t.strokeStyle=`hsla(${n}, 0.2)`,t.stroke(),t.strokeStyle=`hsla(${n}, 0.1)`,t.stroke(),t.shadowOffsetY=-2.5,t.stroke(),t.strokeStyle=`hsla(${n}, 0.2)`,t.stroke(),t.strokeStyle=`hsla(${n}, 0.3)`,t.stroke()}function rt(t,{arc:s,angle:a}){const n={x:s.center.x+Math.cos(a)*s.radius,y:s.center.y+Math.sin(a)*s.radius};t.beginPath(),t.arc(n.x,n.y,5,0,2*Math.PI),t.stroke(),t.stroke()}let u;function ct(t,{unisonWidth:s,durationSeconds:a}={unisonWidth:1,durationSeconds:1}){[-s,0,s].map(c=>{u||(u=new AudioContext);const d=u.createOscillator(),l=u.createGain();l.gain.value=.2,d.connect(l);const o=u.createGain();o.gain.cancelScheduledValues(u.currentTime),l.connect(o),d.type="sine",d.frequency.value=t,d.detune.value=c;const h={attack:0,decay:.05,sustain:{duration:0,intensity:.8},release:.4},f=u.currentTime,x=h.attack*a,k=f+x,g=h.decay*a;o.gain.setValueAtTime(0,f),o.gain.linearRampToValueAtTime(1,k),o.gain.setTargetAtTime(h.sustain.intensity,k,g);const v=k+g+h.sustain.duration*a,M=h.release*a;o.gain.setValueAtTime(h.sustain.intensity,v);const z=v+M;o.gain.linearRampToValueAtTime(0,z);const C=u.sampleRate/2,e=u.createBiquadFilter();return e.type="lowpass",e.frequency.value=.2*C,e.Q.value=23.1,o.connect(e),e.connect(u.destination),d}).forEach(c=>{c.start()})}var dt=J('<div class="relative"><canvas class="relative h-[80dvh] w-full bg-black"></canvas> <!></div>');function xt(t,s){K(s,!0);let a=R(void 0),n=null,c,d=R(!0);const l=[261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88];let o=l.map((e,i,y)=>{const r=2*Math.PI*(50-2*i),T=15*60,_=r/T;return{color:`${i*(360/y.length)},100%, 50%`,tone:l[i],velocity:_,lastImpact:0,nextImpactTime:0}});const h=(e,i)=>e+Math.PI/i*1e3;let f=R(!1);function x({pen:e,paper:i}){c||(c=new Date().getTime(),o.forEach($=>{$.lastImpact=$.nextImpactTime=c}));const y=new Date().getTime(),w=(y-c)/1e3;i.width=i.clientWidth,i.height=i.clientHeight;const r=[{x:i.width*.1,y:i.height*.9},{x:i.width*.9,y:i.height*.9}];e.strokeStyle="#FFFFFF66",e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(r[0].x,r[0].y),e.lineTo(r[1].x,r[1].y),e.stroke();const T=r[1].x-r[0].x,_=.05*T,G=(T/2-_)/(o.length-1),W={x:i.width*.5,y:i.height*.9};o=o.map(({color:$,velocity:F,tone:B,lastImpact:I,nextImpactTime:b},j)=>{const H=_+j*G;lt({pen:e},{radius:H,center:W,hsl:$}),e.lineWidth=2,e.strokeStyle=`hsla(${$}, 1)`,e.shadowBlur=8,e.shadowOffsetY=0;const L=2*Math.PI,S=(Math.PI+w*F)%L,Q=S>=Math.PI?S:L-S;return rt(e,{arc:{radius:H,center:W},angle:Q}),y>b&&(m(d)&&ct(B),I=b,b=h(I,F)),{color:$,tone:B,nextImpactTime:b,lastImpact:I,velocity:F}}),requestAnimationFrame(()=>x({paper:i,pen:e}))}function k(){m(f)?A(d,!m(d)):(n=m(a).getContext("2d"),x({paper:m(a),pen:n}),A(f,!0))}var g=dt();at("visibilitychange",p,()=>{console.log("disabling sound"),A(d,!1)});var v=U(g);v.__click=k,st(v,e=>A(a,e),()=>m(a));var M=X(v,2);{var z=e=>{ot(e,{class:" pointer-events-none absolute left-1/2 top-1/2 size-16 -translate-x-1/2 -translate-y-1/2 transform stroke-gray-300/80 stroke-2"})},C=(e,i)=>{{var y=r=>{it(r,{class:"absolute right-2 top-2 z-10 size-6 stroke-gray-400"})},w=r=>{nt(r,{class:"absolute right-2 top-2 z-10 size-6 stroke-gray-400"})};Y(e,r=>{m(d)?r(y):r(w,!1)},i)}};Y(M,e=>{m(f)?e(C,!1):e(z)})}tt(g),P(t,g),Z()}et(["click"]);export{xt as component};

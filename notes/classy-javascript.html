<!doctype html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/x-icon" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/NoteGridStatusFilter.g3mlLlki.css" rel="stylesheet">
		<link href="../_app/immutable/assets/TronHeading.BM8M17rP.css" rel="stylesheet">
		<link href="../_app/immutable/assets/0.Bg0JPURB.css" rel="stylesheet">
		<link href="../_app/immutable/assets/GlassEffect.Bt-rDUtp.css" rel="stylesheet">
		<link href="../_app/immutable/assets/MDSveXNoteLayout.CyYI4j1f.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.BfmV6CXG.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.DeSrvq4d.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DqmMTPsh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BXuwziPp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/fxLts69-.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CEhbn-nS.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.DUu0rXEm.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1FmrZbK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D9YNmFiP.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/eRUgPH3U.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BwWdE2oG.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BDQsy2mL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bj2ZHtgv.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BH0rJ8lv.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/i38rxh8a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C7Wyn-hp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BMf7CqPI.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.C5PUE4zY.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/eKGY03QC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DBHxkW5N.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DKQuU3a6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_MkR03kS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/55GU2yrD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BI3mvVCd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/gnU0ypJ3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D5me0T6u.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.Ds-0lBTw.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/inYaDieW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CZc86Lzj.js"><!--[--><meta name="description" content="Embark on a journey to learn about how OOP has been done throughout JavaScript's history, with our destination set on understanding how we should do it today and what all the modern syntax is doing for us under the hood." class="svelte-con17z"> <meta property="og:title" content="Classy coding - JavaScript OOP through the ages" class="svelte-con17z"> <meta property="og:type" content="article" class="svelte-con17z"> <meta property="og:url" content="https://allandeutsch.com/notes/classy-javascript" class="svelte-con17z"> <meta property="og:description" content="Embark on a journey to learn about how OOP has been done throughout JavaScript's history, with our destination set on understanding how we should do it today and what all the modern syntax is doing for us under the hood." class="svelte-con17z"> <meta property="og:locale" content="en_US" class="svelte-con17z"> <meta property="twitter:card" content="summary" class="svelte-con17z"> <meta property="twitter:url" content="https://allandeutsch.com" class="svelte-con17z"> <meta property="twitter:title" content="Classy coding - JavaScript OOP through the ages" class="svelte-con17z"> <meta property="twitter:description" content="Embark on a journey to learn about how OOP has been done throughout JavaScript's history, with our destination set on understanding how we should do it today and what all the modern syntax is doing for us under the hood." class="svelte-con17z"> <meta property="twitter:site" content="@AllanDeutsch" class="svelte-con17z"> <meta property="twitter:creator" content="@AllanDeutsch" class="svelte-con17z"> <link rel="canonical" href="https://allandeutsch.com/notes/classy-javascript" class="svelte-con17z"> <script type="module" src="https://docduck.dev/selection.js" class="svelte-con17z"></script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" class="svelte-con17z"></script><!--]--><!--[--><!--[--><meta name="theme-color" content="dark"><!--]--> <!----><script>(function setInitialMode({ defaultMode = "system", themeColors: themeColors2, darkClassNames: darkClassNames2 = ["dark"], lightClassNames: lightClassNames2 = [], defaultTheme = "", modeStorageKey: modeStorageKey2 = "mode-watcher-mode", themeStorageKey: themeStorageKey2 = "mode-watcher-theme" }) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem(modeStorageKey2) || defaultMode;
  const theme2 = localStorage.getItem(themeStorageKey2) || defaultTheme;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  if (light) {
    if (darkClassNames2.length)
      rootEl.classList.remove(...darkClassNames2);
    if (lightClassNames2.length)
      rootEl.classList.add(...lightClassNames2);
  } else {
    if (lightClassNames2.length)
      rootEl.classList.remove(...lightClassNames2);
    if (darkClassNames2.length)
      rootEl.classList.add(...darkClassNames2);
  }
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  if (theme2) {
    rootEl.setAttribute("data-theme", theme2);
    localStorage.setItem(themeStorageKey2, theme2);
  }
  localStorage.setItem(modeStorageKey2, mode);
})({"defaultMode":"system","themeColors":{"dark":"dark","light":"light"},"darkClassNames":["dark"],"lightClassNames":[],"defaultTheme":"","modeStorageKey":"mode-watcher-mode","themeStorageKey":"mode-watcher-theme"});</script><!----><!--]--><title>Classy coding - JavaScript OOP through the ages - Allan Deutsch</title>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
	</head>
	<body
		data-sveltekit-preload-data="hover"
		data-sveltekit-preload-data="viewport"
		class="bg-background h-full min-h-[100vh]">
		<div style="display: contents"><!--[--><!--[--><!----><div class="h-full min-h-[100dvh]"><canvas class="svelte-1pbc9e"></canvas> <canvas class="svelte-1pbc9e"></canvas><!----> <!--[!--><!--]--><!----> <div class="relative flex w-full items-center p-2 print:hidden"><div class="backdrop svelte-1awoxck"></div> <div class="backdrop-edge svelte-1awoxck"></div><!----> <!----><!----><!--[!--><button class="px-4 sm:hidden" id="bits-21" aria-haspopup="menu" aria-expanded="false" data-state="closed" data-dropdown-menu-trigger="" type="button"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg> <span class="sr-only">Open navigation menu</span><!----></button><!--]--><!----><!----> <!----><!----><!--[!--><!--]--><!----><!----><!----><!----><!----><!----> <div class="w-1/2 px-4 text-xl font-semibold text-nowrap"><a href="/"><span class="retrotext text-muted font-bold uppercase svelte-q7kqyc" style="--color: hsl(85, 45%, 55%); --scalar: 0; --hoveredScalar: 0.1; --letters: 13; --duration: 0.3s;"><!--[--><span class="word inline-block svelte-q7kqyc"><!--[--><span class="letter relative svelte-q7kqyc" style="--letter:0">A<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">A</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">A</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:1">l<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">l</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:2">l<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">l</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">l</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:3">a<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">a</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">a</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:4">n<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">n</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">n</span><!--]--></span><!--]--><!--[--><span class="space svelte-q7kqyc"> </span><!--]--></span><span class="word inline-block svelte-q7kqyc"><!--[--><span class="letter relative svelte-q7kqyc" style="--letter:6">D<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">D</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">D</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:7">e<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">e</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">e</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:8">u<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">u</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">u</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:9">t<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">t</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">t</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:10">s<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">s</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">s</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:11">c<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">c</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">c</span><!--]--></span><span class="letter relative svelte-q7kqyc" style="--letter:12">h<!--[--><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">h</span><span class="absolute select-none svelte-q7kqyc" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">h</span><!--]--></span><!--]--><!--[!--><!--]--></span><!--]--></span><!----></a></div> <div class="hidden shrink-0 sm:flex"><ul class="inline-flex w-fit flex-row px-1 text-base"><!--[--><!--[!--><li><a href="/" class="px-3 text-lg"><span class="svelte-ru03ml"><!---->Home<!----></span><!----></a></li><!--]--><!--[!--><li><a href="/notes" class="px-3 text-lg"><span class="svelte-ru03ml"><!---->Notes<!----></span><!----></a></li><!--]--><!--[!--><li><a href="/devlog" class="px-3 text-lg"><span class="svelte-ru03ml"><!---->Devlog<!----></span><!----></a></li><!--]--><!--]--></ul></div> <div class="hidden w-1/2 justify-end min-[400px]:flex"><!--[!--><div><a href="https://linkedin.com/in/allandeutsch" class="group"><span class="sr-only">connect with me on LinkedIn</span> <svg class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300" aria-hidden="true" role="img" width="24" height="24" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M34 2.5v29a2.5 2.5 0 01-2.5 2.5h-29A2.5 2.5 0 010 31.5v-29A2.5 2.5 0 012.5 0h29A2.5 2.5 0 0134 2.5zM10 13H5v16h5zm.45-5.5a2.88 2.88 0 00-2.86-2.9H7.5a2.9 2.9 0 000 5.8 2.88 2.88 0 002.95-2.81zM29 19.28c0-4.81-3.06-6.68-6.1-6.68a5.7 5.7 0 00-5.06 2.58h-.14V13H13v16h5v-8.51a3.32 3.32 0 013-3.58h.19c1.59 0 2.77 1 2.77 3.52V29h5z"></path></svg></a> <a href="https://bsky.app/profile/allandeutsch.com" class="group"><span class="sr-only">Follow me on Bluesky</span> <svg height="24" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300"><title>Bluesky</title><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><span class="sr-only">Follow me on GitHub</span> <svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div><!--]--></div></div><!----> <div class="h-full p-1 sm:p-4"><!----><docduck-feedback team="TKxfdiO22xOXIrW0c0Pfi" class="svelte-con17z"></docduck-feedback> <div class="grid w-full grid-cols-[1fr_min(65ch,100%)_1fr] svelte-con17z"><h1 class="col-start-2 col-end-3 text-left text-4xl font-bold svelte-con17z" style="view-transition-name: title">Classy coding - JavaScript OOP through the ages</h1></div> <article class="note-container dark:prose-invert prose mb-8 max-w-full px-2 svelte-con17z"><header class="w-full max-w-3xl self-center svelte-con17z"><div class="text-md border-t-neutral/20 text-muted-foreground mt-4 mb-12 flex justify-between border-t pt-1 svelte-con17z"><div class="svelte-con17z"><span class="pr-2 svelte-con17z">🌱</span><span class="hidden sm:inline svelte-con17z">Planted</span>August 14, 2024. <!--[!--><!--]--></div> <div class="flex flex-col items-end svelte-con17z"><div class="note__status budding svelte-con17z">budding 🌿</div> <!--[--><div class="svelte-con17z">23 minutes read ⏱</div><!--]--></div></div></header> <!----><p>This blog post was originally presented at SeattleJS in August 2024.</p> <h2 id="constructing-a-class-in-javascript"><a aria-hidden="true" tabindex="-1" href="#constructing-a-class-in-javascript"><span class="icon icon-link"></span></a><a href="#constructing-a-class-in-javascript" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Constructing a class in JavaScript</h2> <p>Object-Oriented Programming (OOP) has been around for a long time and in many languages. JavaScript is no exception to that, which should come as no surprise to anyone using JS today. It hasn’t always been a first-class paradigm in the language, though.</p> <p>Let’s embark on a journey to learn about how OOP has been done throughout JavaScript’s history, with our destination set on understanding how we should do it today and what all the modern syntax is doing for us under the hood.</p> <h3 id="the-prototype-chain"><a aria-hidden="true" tabindex="-1" href="#the-prototype-chain"><span class="icon icon-link"></span></a><a href="#the-prototype-chain" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The prototype chain</h3> <p>Imagine a classic OOP problem - you have a bunch of objects that share an “is a” relationship. This “is a” relationship is typically used to explain when multiple objects should share a “class” type. I’ll use rectangles to keep it easy. So we have a bunch of objects, each of which “is a” rectangle - how do we represent that so and give each rectangle instance the interface a rectangle class should have?</p> <p>To start, let’s make a rectangle instance. Write or paste this code into your browser console to make one:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" data-tsplay="https://typescriptlang.org/play/#code/DYUwLgBATiDGYEYIF4IG8DuBLAJmAFgFwQAsANBPiFgOb5jECsAvgNwBQM8CQA"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">rect1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#998418;--shiki-dark:#B8A965">width</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#998418;--shiki-dark:#B8A965">height</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2F798A;--shiki-dark:#4C9A91">5</span><span style="color:#999999;--shiki-dark:#666666">&#125;;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">rect1</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">let rect1 = &#123;width: 4, height: 5&#125;;
rect1</pre><!----> <p>The second line should cause the console to display a reference to the <code>rect1</code> object. You may have noticed that both properties fit in a single line, but the dev tools still give you an option to expand the object. Isn’t that weird?</p> <picture><source media="(prefers-color-scheme: dark)" srcset="https://img.allandeutsch.com/allandeutschcom-note-images/f72f079f9b507f25ba5f58187d5768d0.png"> <source media="(prefers-color-scheme: light )" srcset="https://img.allandeutsch.com/allandeutschcom-note-images/543e3014b14c74e0bdc5fb83b0c8a034.png"> <img alt="The chrome dev tools showing the rectangle's width and height properties and values, as well as an arrow icon to expand the view."></picture> <p>If my object only those two properties and they both fit on screen, why would I need to expand it?</p> <p>As you’ll quickly find, there’s my <code>height</code> and <code>width</code> properties, as well as some weird <code>[[Prototype]]</code> object. Continuing to expand the <code>[[Prototype]]</code> object reveals a few more things. Some of them, like <code>toString()</code> and <code>hasOwnProperty()</code> probably look familiar. Others, such as <code>isPrototypeOf()</code> may not be.</p> <p>You see, JavaScript has an unusual approach to inheritance called a <em>prototype chain</em>. It’s a linked list of object instances. Each instance makes up one part of the object. I think it’s easier to understand interactive exploration, so crack open your browser dev console or favorite JS REPL and let’s explore!</p> <p>The special <code>[[Prototype]]</code> property on this object by default is called <em>the</em> object prototype. Whenever you create an object in JS, the object prototype is added to your object’s prototype chain automatically. You can also access it without dev tools by using an arcane incantation: <code>rect1.__proto__</code>. Entering that in the dev tools console will show the same thing as expanding the <code>[[Prototype]]</code> object, and that’s because it <em>is</em> the same object.</p> <p>But how does this relate to our rectangle? Well it turns out that you can specify a custom prototype object. Think of prototype objects as a “class” or “class type” from other languages. First, let’s define the functionality of our rectangle class:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" data-tsplay="https://typescriptlang.org/play/#code/MYewdgzgLgBARgQwgUwErOFBYDmAbZGAXhgG8AoASAEsIBlARwFcEAnZALhgDMmxNq4ABQBKMjHZQmrMDCgALWgDoA7tQAmC4kRILl85NRzzYAXwA0VNsgRde-KILCjxk6bL0RVGrQCo5il4GRiYwpuSmQA"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">baseRectangle</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#999999;--shiki-dark:#666666">() &#123; </span><span style="color:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#999999;--shiki-dark:#666666">() &#123; </span><span style="color:#1E754F;--shiki-dark:#4D9375">return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">const baseRectangle = &#123;
	isSquare: function() &#123; return this.width === this.height &#125;,
	area: function() &#123; return this.width * this.height &#125;
&#125;</pre><!----> <p>Now I can add this to the prototype chain for <code>rect1</code>:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" data-tsplay="https://typescriptlang.org/play/#code/E4UwxgLgjAdA+nADsA9hFCAEBeTAjAQwGcQAlcCAgOwHMAbEAbiA"><code><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">rect1</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">__proto__</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> baseRectangle</span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">rect1.__proto__ = baseRectangle;</pre><!----> <p>When accessing a property on an object, if the object doesn’t have the property then the JS runtime will look for it further down the prototype chain (on the <code>__proto__</code> property) of the object. For example, accessing <code>rect1.isSquare()</code>:</p> <ol><li>The JS runtime checks the <code>rect1</code> object, which only has <code>width</code>, <code>height</code>, and <code>__proto__</code> properties.</li> <li>The runtime checks the object at <code>__proto__</code> for <code>isSquare</code> and finds it. Done!</li></ol> <p>As an aside, it’s also worth understanding the <strong>chain</strong> part of the prototype chain. <code>rect1</code> isn’t the only object so far whose prototype was set to the object prototype when created: <code>baseRectangle</code>’s was too! Even though I’ve changed the prototype for <code>rect1</code>, I can still use methods from the prototype object on it. For example, if I want to check if <code>rect1.isPrototypeOf(baseRectangle)</code>, that will work! The JS runtime resolves the call like this:</p> <ol><li>It checks <code>rect1</code> for an <code>isPrototypeOf</code> property and fails to find it.</li> <li>It then checks for <code>rect1.__proto__</code> which exists, so it checks <code>rect1.__proto__</code> for <code>isPrototypeOf</code>.</li> <li><code>rect1.__proto__</code> has no <code>isPrototypeOf</code> method, so it checks if <code>rect1.__proto__.__proto__</code> exists. Since it does, it continues searching the <em>prototype chain</em></li> <li><code>rect1.__proto__.__proto__</code> <em>does</em> have an <code>isPrototypeOf</code> method, so that gets resolved as the <code>rect1.isPrototypeOf()</code> method and is invoked.</li> <li>Extra credit: The function call checks if <code>rect1 === baseRectangle.__proto__</code> and returns false. <code>baseRectangle</code> is the prototype of <code>rect1</code>, not the other way around!</li></ol> <p>So running <code>rect1.isSquare()</code> has the expected behavior:</p> <ul><li>The <code>isSquare()</code> function is found</li> <li><code>rect1</code> is bound as <code>this</code>, so the function has access to its <code>width</code> and <code>height</code> values</li> <li>The console displays <code>20</code>, the result of multiplying <code>4*5</code>.</li></ul> <p>We’re off to a great start, and it’s easy enough to make more rectangles and extend them with the <code>baseRectangle</code> functionality:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> rect2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#998418;--shiki-dark:#B8A965"> width</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 3</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#998418;--shiki-dark:#B8A965"> height</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 3</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#998418;--shiki-dark:#B8A965"> __proto__</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> baseRectangle</span><span style="color:#999999;--shiki-dark:#666666"> &#125;;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">const rect2 = &#123; width: 3, height: 3, __proto__: baseRectangle &#125;;</pre><!----> <p>Explicitly setting <code>__proto__</code> feels pretty gross though. Also, we run into some weird behavior if we mistakenly try to interact with <code>baseRectangle</code> directly. As an example, it has neither a width nor height. Despite that, calling <code>baseRectangle.isSquare()</code> returns <code>true</code>. What the heck?</p> <p>Since <code>baseRectangle</code> has neither <code>width</code> nor <code>height</code>, when <code>isSquare()</code> is invoked directly on it <code>this.width</code> and <code>this.height</code> are both <code>undefined</code>. In JavaScript, <code>undefined === undefined</code>. Yikes!</p> <p>So this approach leaves us with 2 gaping flaws - explicitly setting <code>__proto__</code> is gross and using the prototype object directly has undesirable behavior. Fortunately, there’s an easy way to make this better.</p> <h3 id="encapsulate-prototype-chain-modifications-during-object-construction"><a aria-hidden="true" tabindex="-1" href="#encapsulate-prototype-chain-modifications-during-object-construction"><span class="icon icon-link"></span></a><a href="#encapsulate-prototype-chain-modifications-during-object-construction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Encapsulate prototype chain modifications during object construction</h3> <p>The most common pattern for ensuring new object instances are created consistently is to encapsulate it into a function. This type of function is called a “constructor” function. We can make a “constructor” function that creates an object, sets <code>__proto__</code> on it, and then returns the object. Consumers of this constructor function can pass in the parameters, and the function can handle the icky JS internals for them. Something like this should do the trick:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> makeRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  return</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#998418;--shiki-dark:#B8A965"> __proto__</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> baseRectangle</span><span style="color:#999999;--shiki-dark:#666666"> &#125;;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//                        ^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> aSquare</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#59873A;--shiki-dark:#80A665"> makeRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">aSquare</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">isSquare</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // true</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function makeRectangle(width, height) &#123;
  return &#123; width, height, __proto__: baseRectangle &#125;;
//                        ^^^^^^^^^^^^^^^^^^^^^^^^
&#125;

const aSquare = makeRectangle(4,4);
aSquare.isSquare(); // true</pre><!----> <p>That’s easy enough! Unfortunately the <code>baseRectangle</code> object still needs to be defined somewhere and it could be mistakenly used. Also, this whole <code>__proto__</code> syntax is pretty gross and feels like a leaky abstraction. This code is hard to understand if you haven’t explicitly learned about the prototype chain and the magic <code>__proto__</code> member. I’d been using JS for several years before I learned about it!</p> <p>How can we make this better? Fortunately, OG JavaScript has an answer!</p> <h3 id="the-new-operator"><a aria-hidden="true" tabindex="-1" href="#the-new-operator"><span class="icon icon-link"></span></a><a href="#the-new-operator" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The <code>new</code> operator</h3> <p>This pattern - using a constructor to setup an object’s prototype chain - is the original design intent. The above example gets some of the details wrong, though:</p> <ul><li>Implementing a prototype object that is floating around</li> <li>Implementing a separate constructor function</li> <li>Explicitly setting the <code>__proto__</code> property</li></ul> <p>JavaScript has an alternate syntax for setting up a prototype chain, and it hinges on another unique feature of the language. As it turns out, functions in JavaScript are objects. Don’t believe me? Try this out:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">console</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">log</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"> makeRectangle</span><span style="color:#AB5959;--shiki-dark:#CB7676"> instanceof</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Object</span><span style="color:#999999;--shiki-dark:#666666"> );</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// true</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">console.log( makeRectangle instanceof Object );
// true</pre><!----> <p>Practically, this means functions can have properties just like any other object. Functions also have a <code>__proto__</code> property by default - they get the <em>function</em> prototype object. If you’ve ever noticed that functions have methods like <code>apply</code> and <code>bind</code> on them: this is why.</p> <p>The <em>function</em> prototype object in turn has its <code>__proto__</code> set to the <em>object</em> prototype. So the prototype chain for a function (which is an object) has both the <strong>function prototype</strong> and the <strong>object prototype</strong>. Looking at the properties of a function, we can values from both. These include <code>apply</code> from the <strong>function</strong> prototype and <code>toString</code> from the <strong>object</strong> prototype.</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark twoslash lsp" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash data-tsplay="https://typescriptlang.org/play/#code/PTAEAEFMCdoe2gZwFygOwAYBMBmUucBOdDDANgCgBjOAO0QBdQAjAQ0UgCVIqHXaA5gBtIoALygA3hQCQAS0QBlAI4BXVtEioAZqtq85dABQBKVMzhwR-KaE0NV0WqAYALBQDoA7nIAmb8TEJN09XSDkBVyYAXwAaWQ1IVh09A2MzUFpVAFtmGFt7R2cQxG8-AIAqF3dSsIio0GiKaIBuCgpdfQZDZ2zWAGsuHj5BESMff1dY0DrIhhMpClA7SAcnWwm3admo6YB9PYAHeAY4A-N2Id5+YVFW5ooQAFoXqlUGF6eKPsHua9HIB5WIdDkIAJ6PMDLaEw5YAPQAPu1kSigA"><code><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> makeRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">any</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">any</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    width</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">any</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    height</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">any</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    __proto__</span><span style="color:#999999;--shiki-dark:#666666">: &#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">        isSquare</span><span style="color:#999999;--shiki-dark:#666666">: () => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">boolean</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">        area</span><span style="color:#999999;--shiki-dark:#666666">: () => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">number</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    &#125;;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>makeRectangle</span></span><span style="color:#999999;--shiki-dark:#666666"><span>.<span class="twoslash-completion-cursor"><ul class="twoslash-completion-list"><li><span class="twoslash-completions-icon completions-method"><svg viewBox="0 0 32 32"><path fill="currentColor" d="m19.626 29.526l-.516-1.933a12.004 12.004 0 0 0 6.121-19.26l1.538-1.28a14.003 14.003 0 0 1-7.143 22.473"></path><path fill="currentColor" d="M10 29H8v-3.82l.804-.16C10.262 24.727 12 23.62 12 20v-1.382l-4-2v-2.236l4-2V12c0-5.467 3.925-9 10-9h2v3.82l-.804.16C21.738 7.273 20 8.38 20 12v.382l4 2v2.236l-4 2V20c0 5.467-3.925 9-10 9m0-2c4.935 0 8-2.682 8-7v-2.618l3.764-1.882L18 13.618V12c0-4.578 2.385-6.192 4-6.76V5c-4.935 0-8 2.682-8 7v1.618L10.236 15.5L14 17.382V20c0 4.578-2.385 6.192-4 6.76Z"></path><path fill="currentColor" d="M5.231 24.947a14.003 14.003 0 0 1 7.147-22.474l.516 1.932a12.004 12.004 0 0 0-6.125 19.263Z"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">apply</span></span></li><li><span class="twoslash-completions-icon completions-property"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M12.1 2a9.8 9.8 0 0 0-5.4 1.6l6.4 6.4a2.1 2.1 0 0 1 .2 3a2.1 2.1 0 0 1-3-.2L3.7 6.4A9.84 9.84 0 0 0 2 12.1a10.14 10.14 0 0 0 10.1 10.1a10.9 10.9 0 0 0 2.6-.3l6.7 6.7a5 5 0 0 0 7.1-7.1l-6.7-6.7a10.9 10.9 0 0 0 .3-2.6A10 10 0 0 0 12.1 2m8 10.1a7.61 7.61 0 0 1-.3 2.1l-.3 1.1l.8.8l6.7 6.7a2.88 2.88 0 0 1 .9 2.1A2.72 2.72 0 0 1 27 27a2.9 2.9 0 0 1-4.2 0l-6.7-6.7l-.8-.8l-1.1.3a7.61 7.61 0 0 1-2.1.3a8.27 8.27 0 0 1-5.7-2.3A7.63 7.63 0 0 1 4 12.1a8.33 8.33 0 0 1 .3-2.2l4.4 4.4a4.14 4.14 0 0 0 5.9.2a4.14 4.14 0 0 0-.2-5.9L10 4.2a6.45 6.45 0 0 1 2-.3a8.27 8.27 0 0 1 5.7 2.3a8.49 8.49 0 0 1 2.4 5.9"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">arguments</span></span></li><li><span class="twoslash-completions-icon completions-method"><svg viewBox="0 0 32 32"><path fill="currentColor" d="m19.626 29.526l-.516-1.933a12.004 12.004 0 0 0 6.121-19.26l1.538-1.28a14.003 14.003 0 0 1-7.143 22.473"></path><path fill="currentColor" d="M10 29H8v-3.82l.804-.16C10.262 24.727 12 23.62 12 20v-1.382l-4-2v-2.236l4-2V12c0-5.467 3.925-9 10-9h2v3.82l-.804.16C21.738 7.273 20 8.38 20 12v.382l4 2v2.236l-4 2V20c0 5.467-3.925 9-10 9m0-2c4.935 0 8-2.682 8-7v-2.618l3.764-1.882L18 13.618V12c0-4.578 2.385-6.192 4-6.76V5c-4.935 0-8 2.682-8 7v1.618L10.236 15.5L14 17.382V20c0 4.578-2.385 6.192-4 6.76Z"></path><path fill="currentColor" d="M5.231 24.947a14.003 14.003 0 0 1 7.147-22.474l.516 1.932a12.004 12.004 0 0 0-6.125 19.263Z"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">bind</span></span></li><li><span class="twoslash-completions-icon completions-method"><svg viewBox="0 0 32 32"><path fill="currentColor" d="m19.626 29.526l-.516-1.933a12.004 12.004 0 0 0 6.121-19.26l1.538-1.28a14.003 14.003 0 0 1-7.143 22.473"></path><path fill="currentColor" d="M10 29H8v-3.82l.804-.16C10.262 24.727 12 23.62 12 20v-1.382l-4-2v-2.236l4-2V12c0-5.467 3.925-9 10-9h2v3.82l-.804.16C21.738 7.273 20 8.38 20 12v.382l4 2v2.236l-4 2V20c0 5.467-3.925 9-10 9m0-2c4.935 0 8-2.682 8-7v-2.618l3.764-1.882L18 13.618V12c0-4.578 2.385-6.192 4-6.76V5c-4.935 0-8 2.682-8 7v1.618L10.236 15.5L14 17.382V20c0 4.578-2.385 6.192-4 6.76Z"></path><path fill="currentColor" d="M5.231 24.947a14.003 14.003 0 0 1 7.147-22.474l.516 1.932a12.004 12.004 0 0 0-6.125 19.263Z"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">call</span></span></li><li><span class="twoslash-completions-icon completions-property"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M12.1 2a9.8 9.8 0 0 0-5.4 1.6l6.4 6.4a2.1 2.1 0 0 1 .2 3a2.1 2.1 0 0 1-3-.2L3.7 6.4A9.84 9.84 0 0 0 2 12.1a10.14 10.14 0 0 0 10.1 10.1a10.9 10.9 0 0 0 2.6-.3l6.7 6.7a5 5 0 0 0 7.1-7.1l-6.7-6.7a10.9 10.9 0 0 0 .3-2.6A10 10 0 0 0 12.1 2m8 10.1a7.61 7.61 0 0 1-.3 2.1l-.3 1.1l.8.8l6.7 6.7a2.88 2.88 0 0 1 .9 2.1A2.72 2.72 0 0 1 27 27a2.9 2.9 0 0 1-4.2 0l-6.7-6.7l-.8-.8l-1.1.3a7.61 7.61 0 0 1-2.1.3a8.27 8.27 0 0 1-5.7-2.3A7.63 7.63 0 0 1 4 12.1a8.33 8.33 0 0 1 .3-2.2l4.4 4.4a4.14 4.14 0 0 0 5.9.2a4.14 4.14 0 0 0-.2-5.9L10 4.2a6.45 6.45 0 0 1 2-.3a8.27 8.27 0 0 1 5.7 2.3a8.49 8.49 0 0 1 2.4 5.9"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">caller</span></span></li><li><span class="twoslash-completions-icon completions-property"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M12.1 2a9.8 9.8 0 0 0-5.4 1.6l6.4 6.4a2.1 2.1 0 0 1 .2 3a2.1 2.1 0 0 1-3-.2L3.7 6.4A9.84 9.84 0 0 0 2 12.1a10.14 10.14 0 0 0 10.1 10.1a10.9 10.9 0 0 0 2.6-.3l6.7 6.7a5 5 0 0 0 7.1-7.1l-6.7-6.7a10.9 10.9 0 0 0 .3-2.6A10 10 0 0 0 12.1 2m8 10.1a7.61 7.61 0 0 1-.3 2.1l-.3 1.1l.8.8l6.7 6.7a2.88 2.88 0 0 1 .9 2.1A2.72 2.72 0 0 1 27 27a2.9 2.9 0 0 1-4.2 0l-6.7-6.7l-.8-.8l-1.1.3a7.61 7.61 0 0 1-2.1.3a8.27 8.27 0 0 1-5.7-2.3A7.63 7.63 0 0 1 4 12.1a8.33 8.33 0 0 1 .3-2.2l4.4 4.4a4.14 4.14 0 0 0 5.9.2a4.14 4.14 0 0 0-.2-5.9L10 4.2a6.45 6.45 0 0 1 2-.3a8.27 8.27 0 0 1 5.7 2.3a8.49 8.49 0 0 1 2.4 5.9"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">length</span></span></li><li><span class="twoslash-completions-icon completions-property"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M12.1 2a9.8 9.8 0 0 0-5.4 1.6l6.4 6.4a2.1 2.1 0 0 1 .2 3a2.1 2.1 0 0 1-3-.2L3.7 6.4A9.84 9.84 0 0 0 2 12.1a10.14 10.14 0 0 0 10.1 10.1a10.9 10.9 0 0 0 2.6-.3l6.7 6.7a5 5 0 0 0 7.1-7.1l-6.7-6.7a10.9 10.9 0 0 0 .3-2.6A10 10 0 0 0 12.1 2m8 10.1a7.61 7.61 0 0 1-.3 2.1l-.3 1.1l.8.8l6.7 6.7a2.88 2.88 0 0 1 .9 2.1A2.72 2.72 0 0 1 27 27a2.9 2.9 0 0 1-4.2 0l-6.7-6.7l-.8-.8l-1.1.3a7.61 7.61 0 0 1-2.1.3a8.27 8.27 0 0 1-5.7-2.3A7.63 7.63 0 0 1 4 12.1a8.33 8.33 0 0 1 .3-2.2l4.4 4.4a4.14 4.14 0 0 0 5.9.2a4.14 4.14 0 0 0-.2-5.9L10 4.2a6.45 6.45 0 0 1 2-.3a8.27 8.27 0 0 1 5.7 2.3a8.49 8.49 0 0 1 2.4 5.9"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">name</span></span></li><li><span class="twoslash-completions-icon completions-property"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M12.1 2a9.8 9.8 0 0 0-5.4 1.6l6.4 6.4a2.1 2.1 0 0 1 .2 3a2.1 2.1 0 0 1-3-.2L3.7 6.4A9.84 9.84 0 0 0 2 12.1a10.14 10.14 0 0 0 10.1 10.1a10.9 10.9 0 0 0 2.6-.3l6.7 6.7a5 5 0 0 0 7.1-7.1l-6.7-6.7a10.9 10.9 0 0 0 .3-2.6A10 10 0 0 0 12.1 2m8 10.1a7.61 7.61 0 0 1-.3 2.1l-.3 1.1l.8.8l6.7 6.7a2.88 2.88 0 0 1 .9 2.1A2.72 2.72 0 0 1 27 27a2.9 2.9 0 0 1-4.2 0l-6.7-6.7l-.8-.8l-1.1.3a7.61 7.61 0 0 1-2.1.3a8.27 8.27 0 0 1-5.7-2.3A7.63 7.63 0 0 1 4 12.1a8.33 8.33 0 0 1 .3-2.2l4.4 4.4a4.14 4.14 0 0 0 5.9.2a4.14 4.14 0 0 0-.2-5.9L10 4.2a6.45 6.45 0 0 1 2-.3a8.27 8.27 0 0 1 5.7 2.3a8.49 8.49 0 0 1 2.4 5.9"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">prototype</span></span></li><li><span class="twoslash-completions-icon completions-method"><svg viewBox="0 0 32 32"><path fill="currentColor" d="m19.626 29.526l-.516-1.933a12.004 12.004 0 0 0 6.121-19.26l1.538-1.28a14.003 14.003 0 0 1-7.143 22.473"></path><path fill="currentColor" d="M10 29H8v-3.82l.804-.16C10.262 24.727 12 23.62 12 20v-1.382l-4-2v-2.236l4-2V12c0-5.467 3.925-9 10-9h2v3.82l-.804.16C21.738 7.273 20 8.38 20 12v.382l4 2v2.236l-4 2V20c0 5.467-3.925 9-10 9m0-2c4.935 0 8-2.682 8-7v-2.618l3.764-1.882L18 13.618V12c0-4.578 2.385-6.192 4-6.76V5c-4.935 0-8 2.682-8 7v1.618L10.236 15.5L14 17.382V20c0 4.578-2.385 6.192-4 6.76Z"></path><path fill="currentColor" d="M5.231 24.947a14.003 14.003 0 0 1 7.147-22.474l.516 1.932a12.004 12.004 0 0 0-6.125 19.263Z"></path></svg></span><span><span class="twoslash-completions-matched"></span><span class="twoslash-completions-unmatched">toString</span></span></li></ul></span></span></span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">CallableFunction</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">apply</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#999999;--shiki-dark:#666666">>(</span><span style="color:#A65E2B;--shiki-dark:#C99076">this</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">this</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#B07D48;--shiki-dark:#BD976A"> R</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> thisArg</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">T</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#59873A;--shiki-dark:#80A665">R</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></code><div class="twoslash-popup-docs">Calls the function with the specified object as the this value and the elements of specified array as the arguments.</div><div class="twoslash-popup-docs twoslash-popup-docs-tags"><span class="twoslash-popup-docs-tag"><span class="twoslash-popup-docs-tag-name">@param</span><span class="twoslash-popup-docs-tag-value">thisArg The object to be used as the this object.</span></span></div></span>apply</span></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><!----><!----><pre class="code-copy-target hidden">// @errors: 7023 2339 7006
const baseRectangle = &#123;
	isSquare: function(): boolean &#123; return this.width === this.height &#125;,
	area: function(): number &#123; return this.width * this.height &#125;
&#125;;

function makeRectangle(width, height) &#123;
  return &#123; width, height, __proto__: baseRectangle &#125;;
&#125;
//---cut---
makeRectangle.apply
//            ^|








</pre><!----> <p>“Okay Allan, how is the fact that functions are objects relevant to constructor functions?” Great question! The short answer is that if we want to implement a class, we don’t need to define the class interface (prototype object) and the class constructor function as <em>separate</em> entities.</p> <p>Instead, the prototype object should be a property of the constructor function object. for example:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> constructRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	return</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#998418;--shiki-dark:#B8A965"> __proto__</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#998418;--shiki-dark:#B8A965"> constructRectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">prototype</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">constructRectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">prototype</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> rect3</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#59873A;--shiki-dark:#80A665"> constructRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">rect3</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">isSquare</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // false</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function constructRectangle(width, height) &#123;
	return &#123; width, height, __proto__: constructRectangle.prototype &#125;
&#125;
constructRectangle.prototype = &#123;
	isSquare: function() &#123; return this.width === this.height &#125;,
	area: function() &#123; return this.width * this.height &#125;
&#125;;

const rect3 = constructRectangle(1,2);
rect3.isSquare(); // false</pre><!----> <p>This solves the problem of the floating rectangle prototype; it’s now firmly anchored to the constructor function where it belongs. It still has some shortcomings though:</p> <ol><li>Explicitly setting the <code>__proto__</code> on the rectangle instance it returns</li> <li>In fact, everything about <code>__proto__: constructRectangle.prototype</code> is icky.</li> <li>I still have to explicitly create and return the new object I’m constructing.</li></ol> <p>JavaScript has a special solution for this: the <code>new</code> operator. It gets placed before a function call, ie <code>new rectangle(...)</code> and it augments the function call with some special behavior:</p> <ol><li>it creates a <em>new</em> (heh) object</li> <li>It sets the new object’s <code>__proto__</code> property to the function’s <code>prototype</code> property.</li> <li>it bind <code>this</code> to the new object in the function call, equivalent to doing <code>rectangle.apply(newObj, ...)</code></li> <li>The expression evaluates to the new object after the function call returns</li></ol> <p>That’s a lot to take in! It might be easier to understand with an example of the <code>new</code> (heh) version of my rectangle constructor function and its usage:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// when called with &#96;new&#96;:</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// 1. &#96;this&#96; is set to a new object.</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// Just set the properties directly!</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">	this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">	this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// 2. the __proto__ is set automatically to &#96;Rectangle.prototype&#96;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// No need to set it explicitly here!</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">	</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// 3. The &#96;new&#96; expression resolves as &#96;this&#96; new object</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// no need to explicitly return it.</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">Rectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">prototype</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676">     function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676">  *</span><span style="color:#A65E2B;--shiki-dark:#C99076">  this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// usage:</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> rect4</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">rect4</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // ...undefined?</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function Rectangle(width, height) &#123;
	// when called with &#96;new&#96;:
	// 1. &#96;this&#96; is set to a new object.
	// Just set the properties directly!
	this.width = width;
	this.height = height;

	// 2. the __proto__ is set automatically to &#96;Rectangle.prototype&#96;
	// No need to set it explicitly here!
	

	// 3. The &#96;new&#96; expression resolves as &#96;this&#96; new object
	// no need to explicitly return it.
&#125;
Rectangle.prototype = &#123;
	isSquare: function() &#123; return this.width === this.height &#125;,
	area:     function() &#123; return this.width  *  this.height &#125;
&#125;;

// usage:
const rect4 = Rectangle(2,4)
rect4; // ...undefined?</pre><!----> <p>Why is <code>rect4</code> undefined? Because <code>Rectangle</code> was called without using <code>new</code>. Yikes! Fortunately, it’s an easy fix.</p> <blockquote><p>I presented this talk at the SeattleJS August 2024 meetup, where a couple people had a great question: what is the <code>this</code> object that <code>Rectangle()</code> sets a <code>width</code> and <code>height</code> on when it is called <em>without</em> <code>new</code>?</p> <p>The answer, as usual, is “it depends.” Since <code>this</code> isn’t bound for the function call, it will use the global this in the context of the call. In a browser <code>this</code> is the window object. In node at the top level, <code>this</code> is the <code>globalThis</code> object. In an ES module, <code>this</code> is undefined.</p></blockquote> <p>The easy fix is to prefix the <code>Rectangle()</code> call with <code>new</code>:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> rect5</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">rect5</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">isSquare</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // false</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">const rect5 = new Rectangle(2,4);
rect5.isSquare(); // false</pre><!----> <p>Whew, that works! Overall I think this code looks a lot cleaner than before. The <code>Rectangle</code> class interface is neatly encapsulated as <code>Rectangle.prototype</code>. Once you’re familiar with the <code>new</code> operator this code is easy to read.</p> <blockquote><p>Once you’re familiar with the <code>new</code> operator this code is easy to read.</p></blockquote> <p>Hold up! That’s not great. In fact, it might be terrible. If you call it without <code>new</code>, this version of the <code>Rectangle</code> constructor just touches itself and doesn’t produce anything.</p> <p>Worse than that, anyone unfortunate enough to call a constructor <em>without</em> <code>new</code> won’t even be given an error. Just the mysterious nothingness that is <code>undefined</code>, quietly slipped into your variable under the table in hopes that nobody notices. Spectacular! Why would anyone use this stupid language?</p> <p>Browsers! Right, of course. So how do we fix this?</p> <h3 id="ensuring-constructors-are-called-correctly"><a aria-hidden="true" tabindex="-1" href="#ensuring-constructors-are-called-correctly"><span class="icon icon-link"></span></a><a href="#ensuring-constructors-are-called-correctly" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Ensuring constructors are called correctly</h3> <p>There are a few approaches. One is a simple convention - constructor functions start with a capital letter (like <code>Rectangle</code>) and everything else starts with a lower case. The convention of capitalizing class names is common in other OOP languages too. If you didn’t know, now ya know!</p> <p>Helpful, but we’ve still got a weird IYKYK situation going on here. If you don’t know you’re supposed to use <code>new</code> with capitalized functions, you’re going to get an <code>undefined</code> and that’s not helpful. It would be great if <em>inside</em> the constructor function we could check if <code>new</code> was used. That would work to verify <em>this</em> call was made correctly.</p> <p>Speaking of <em>this</em>, <code>this</code> is set if <code>new</code> was used. I’ll just check that inside my constructor function!</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">__proto__</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !==</span><span style="color:#998418;--shiki-dark:#B8A965"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">prototype</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">		// call this function correctly</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">	this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">	this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">Rectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">prototype</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676">     function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676">  *</span><span style="color:#A65E2B;--shiki-dark:#C99076">  this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// usage</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> newRect</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 2</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> alsoNewRect</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">3.1415</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 3.1415</span><span style="color:#999999;--shiki-dark:#666666">);</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function Rectangle(width, height) &#123;
	if(this.__proto__ !== Rectangle.prototype) &#123;
		// call this function correctly
		return new Rectangle(width, height);
	&#125;
	this.width = width;
	this.height = height;
&#125;
Rectangle.prototype = &#123;
	isSquare: function() &#123; return this.width === this.height &#125;,
	area:     function() &#123; return this.width  *  this.height &#125;
&#125;

// usage
const newRect = new Rectangle(1, 2);
const alsoNewRect = Rectangle(3.1415, 3.1415);</pre><!----> <p>Now the only way to screw up this function call is by not passing it a width and height. That feels like a reasonable expectation to have of a <code>Rectangle</code> consumer.</p> <p>It comes at a cost, though: that nasty <code>__proto__</code> JS implementation detail crept back in. Gross! If only there were a better way to check what <code>this</code> is…</p> <p>As I’m sure you can guess at this point, there is! It’s been around since way back in the days of ECMAScript 1, the first standardized JS release from 1997. We’ve got a whole ‘nother keyword <em>just for this</em>! You’ve probably used it whenever you wanted to know if an object was an <code>instanceof</code> a class. Now you know what it’s doing under the hood!</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">this</span><span style="color:#AB5959;--shiki-dark:#CB7676"> instanceof</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// ...</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function Rectangle(width, height) &#123;
	if( !(this instanceof Rectangle) ) &#123;
		return new Rectangle(width, height);
	&#125;
	// ...
&#125;</pre><!----> <p>There are a couple things I love about where we ended up here:</p> <ol><li>The <em>intention</em> of this code is extremely clear. It’s easy to understand even if you don’t know the behavior of the <code>new</code> operator or the JS prototype chain implementation details.</li> <li>If you are making a constructor, this pattern at the top of the function makes it recognizable as one. IYKYK</li></ol> <p>This style of if statement, which checks that a necessary condition is met and if not the function returns early, is called a <em>guard clause</em>. They’re a great technique for keeping code readable.</p> <h4 id="factory-functions"><a aria-hidden="true" tabindex="-1" href="#factory-functions"><span class="icon icon-link"></span></a><a href="#factory-functions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Factory functions</h4> <p>Another approach is to avoid the prototype chain, constructor functions, and <code>new</code> entirely. Instead, the <em>factory pattern</em> can be used. If you’re not familiar, the factory pattern uses a “factory function” to produce objects of some standardized format, very similar to a constructor function. Here’s a factory example:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> makeRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	return</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">		width</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">		height</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">		isSquare</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#999999;--shiki-dark:#666666"> &#125;,</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">		area</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">function makeRectangle(width, height) &#123;
	return &#123;
		width,
		height,
		isSquare: function() &#123; return width === height; &#125;,
		area: function() &#123; return width * height; &#125;
	&#125;
&#125;</pre><!----> <p>This looks a lot like an earlier version of the constructor function. It has a few downsides compared to using a class constructor though:</p> <ol><li>The factory creates a new copy of the <code>isSquare</code> and <code>area</code> functions for each object instance it creates. That’s because the functions need to create a “closure” which captures a reference to the <code>width</code> and <code>height</code> values for the instance - every object has its own copy and each copy uses memory. <strong>Objects created using a constructor share one prototype object instance, reducing memory usage.</strong></li> <li>The <code>instanceof</code> operator can be used anywhere. I can check if any object was made using a specific constructor with <code>obj instanceof Rectangle</code>. As we learned, it works by checking the <code>__proto__</code> of an object. Factory functions don’t set <code>__proto__</code>, so you can’t check if an object was produced by a specific factory function with <code>instanceof</code>.</li></ol> <p>Generally speaking, if a constructor function can do what you need, it’s a better choice than a factory function. There are cases where a factory function is better, but that is a topic for another article…</p> <p>So now we have a good understanding of how to create a bunch of objects of the same “class” in JS. What’s next?</p> <h2 id="getting-classy"><a aria-hidden="true" tabindex="-1" href="#getting-classy"><span class="icon icon-link"></span></a><a href="#getting-classy" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Getting classy</h2> <p>Since the first JavaScript standard, ECMAScript 1, this was the best way to write <code>class</code>y code in JavaScript.</p> <p>🕐 🕝 🕤 🕛 <em>20 years later</em></p> <p>Then along came ECMAScript 6 (ES2015), and with it the introduction of official support for <code>class</code>es and <code>constructor</code>s in JavaScript. Here’s what a rewrite using the new syntax looks like:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">class</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// It's explicitly called a constructor now</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// This makes it much more discoverable for a new dev</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">	constructor</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">	// No longer need to use &#96;__proto__&#96; or &#96;prototype&#96; properties</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// usage</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> classyRectangle</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 7</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">classyRectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">isSquare</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // false</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">classyRectangle</span><span style="color:#AB5959;--shiki-dark:#CB7676"> instanceof</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // true</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> classyRectangle2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 6</span><span style="color:#999999;--shiki-dark:#666666">);</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // ERROR!</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">class Rectangle &#123;
	// It's explicitly called a constructor now
	// This makes it much more discoverable for a new dev
	constructor( width, height ) &#123;
		this.width = width;
		this.height = height;
	&#125;

	// No longer need to use &#96;__proto__&#96; or &#96;prototype&#96; properties
	isSquare() &#123;
		return this.width === this.height;
	&#125;

	area() &#123;
		return this.width * this.height;
	&#125;
&#125;

// usage
const classyRectangle = new Rectangle(1, 7);
classyRectangle.isSquare(); // false
classyRectangle instanceof Rectangle; // true
const classyRectangle2 = Rectangle(1, 6); // ERROR!</pre><!----> <p>This has lots of amazing improvements. First and foremost, the intent is much more clearly communicated to the reader. This is <em>explicitly</em> a <code>class</code>, not just a function that walks and talks like one. Any programmer new to JS can figure out they should search for <code>class javascript</code> for more information to help them understand what’s going on.</p> <p>This continues with the explicit requirement of a function named <code>constructor</code>. Very searchable, very explicit. When <code>new Rectangle()</code> is written, the <code>Rectangle</code> class <code>constructor</code> method gets called. No more sketchy functions that touch themselves, now our code is so <code>class</code>y it can’t be missed!</p> <p>The special behavior of <code>new</code> better hidden now too. It’s not as important to understand it’s behavior when used with a <code>class</code>. Most importantly, trying to construct a <code>Rectangle</code> without <code>new</code> provides an extremely clear and easy to understand error message:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span>Uncaught TypeError: Class constructor Rectangle cannot be invoked without 'new'</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">Uncaught TypeError: Class constructor Rectangle cannot be invoked without 'new'</pre><!----> <p>Amazing! As a result, we no longer need to start every constructor with a guard that checks <code>this instanceof Rectangle</code>. Less code to write, less code to read, and easier to understand what’s going on. Fantastic!</p> <p>Finally, we no longer need to explicitly set up a <code>prototype</code> object. Put the members on the <code>class</code> object, and anything that is set outside the <code>constructor()</code> function is automatically put onto the prototype by the JS runtime. This change means you can now use classes effectively without understanding all the complexity of the prototype chain.</p> <h2 id="protecting-your-privates"><a aria-hidden="true" tabindex="-1" href="#protecting-your-privates"><span class="icon icon-link"></span></a><a href="#protecting-your-privates" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Protecting your privates</h2> <p>Fast-forward a while and we are constructing classy <code>Rectangle</code>s all over the place. One of our uses involves packing rectangles together. This was working great until the packed <code>Rectangle</code>s started shape-shifting. Somewhere, somehow, the packed rectangles are being <em>mutated</em>. It’s really easy to do:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> shapeshiftingRectangle</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// pack away the rectangle...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// and now it can still be changed! yikes</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">shapeshiftingRectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 640</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">shapeshiftingRectangle</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 480</span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">const shapeshiftingRectangle = new Rectangle(1,2);
// pack away the rectangle...

// and now it can still be changed! yikes
shapeshiftingRectangle.width = 640;
shapeshiftingRectangle.height = 480;</pre><!----> <p>Aaaah! The <code>Rectangle</code>s private dimensions are exposed, and can therefore be changed. This exhibitionist behavior is unbefitting of a <code>class</code>y <code>Rectangle</code>.</p> <p>We need a version of <code>Rectangle</code> that isn’t such an exhibitionist. Its <code>width</code> and <code>height</code> are private, and should be treated as such so nobody else can touch them.</p> <p>Through JavaScript’s long history, the answer has typically been a closure. Closures work because of how memory is managed in JS. As long as a a variable is referenced somewhere, it will be kept in memory. If we create a function that references a local variable, it forms a closure and keeps the variable in memory. So consider this version of the <code>Rectangle</code> class:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">class</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ImmutableRectangle</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">	constructor</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">		const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> _width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">		const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> _height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">		// Now the values are only exposed as functions</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">		// Can't change the values now!</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">width</span><span style="color:#999999;--shiki-dark:#666666">    =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#B07D48;--shiki-dark:#BD976A"> _width</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#999999;--shiki-dark:#666666">  &#125;;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">height</span><span style="color:#999999;--shiki-dark:#666666">   =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> return</span><span style="color:#B07D48;--shiki-dark:#BD976A"> _height</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#999999;--shiki-dark:#666666"> &#125;;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">	</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">width</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">height</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">width</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#AB5959;--shiki-dark:#CB7676">  *</span><span style="color:#A65E2B;--shiki-dark:#C99076">  this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">height</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> </span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// usage</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> immutableRect</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> ImmutableRectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 5</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">immutableRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">width</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // [Function (anonymous)]</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">immutableRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">width</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // 4</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">immutableRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">_width</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // undefined</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">immutableRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">isSquare</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // false</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">class ImmutableRectangle &#123;
	constructor(width, height) &#123;
		const _width = width;
		const _height = height;

		// Now the values are only exposed as functions
		// Can't change the values now!
		this.width    = function() &#123; return _width;  &#125;;
		this.height   = function() &#123; return _height; &#125;;
	&#125;	
	isSquare() &#123; 
		return this.width() === this.height(); 
	&#125;
	area() &#123; 
		return this.width()  *  this.height(); 
	&#125;
&#125;
// usage
const immutableRect = new ImmutableRectangle(4, 5);
immutableRect.width; // [Function (anonymous)]
immutableRect.width(); // 4
immutableRect._width; // undefined
immutableRect.isSquare(); // false</pre><!----> <p>Since the <code>_width</code> and <code>_height</code> are <code>const</code> values and only accessible from inside the <code>Rectangle</code>’s <code>constructor</code> function, they are “private” and nobody else can see or touch them. I solved the “see them” problem by adding a couple getter functions, <code>width()</code> and <code>height()</code>, which return their respective values. This lets me protect my <code>Rectangle</code>’s privates, but it comes at a cost.</p> <p>Similar to a factory function, each constructor call is creating a new copy of the <code>width()</code> and <code>height()</code> functions to form a closure on its <code>_width</code> and <code>_height</code>, using more memory. That’s not a terrible way to make sure <code>Rectangle</code>’s members are private. As it turns out, even with the introduction of classes in ES6 that is the best way to do it. The end.</p> <p>🕐 🕝 <em>7 years later</em></p> <p>After another long wait, ECMAScript 2022 (ES13) came along and introduced proper language-level support for private properties. These classy new classes can finally hide their privates. Unlike TikTok and Instagram, hashtags in JS are for the <em>opposite</em> of discoverability. <code>#private</code> <code>#youcantseeme</code> eh? Check this out:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">class</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">	#width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">	#height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">	constructor</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#width</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> width</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">		this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#height</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	isSquare</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ===</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	area</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">		return</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#width</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#A65E2B;--shiki-dark:#C99076"> this</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#height</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">	&#125;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let</span><span style="color:#B07D48;--shiki-dark:#BD976A"> privateRect</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> Rectangle</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">privateRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">area</span><span style="color:#999999;--shiki-dark:#666666">();</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // 2</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">privateRect</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">#width</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> // Error!</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">class Rectangle &#123;
	#width;
	#height;
	constructor( width, height ) &#123;
		this.#width = width;
		this.#height = height;
	&#125;
	isSquare() &#123;
		return this.#width === this.#height;
	&#125;
	area() &#123;
		return this.#width * this.#height;
	&#125;
&#125;
let privateRect = new Rectangle(1,2);
privateRect.area(); // 2
privateRect.#width; // Error!</pre><!----> <p>Now the runtime will not let anyone else touch our <code>Rectangle</code>’s privates!</p> <p>As of 2022 we’ve finally got language-level support for basic Object-Oriented Programming in JavaScript!</p> <p>It’s been quite a journey to get here. I hope it was a fun one!</p><!----><!----> <div class="divider svelte-con17z"></div> <aside class="prose dark:prose-invert svelte-con17z"><p class="svelte-con17z">If you're feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider svelte-con17z"></div></aside></article> <!----><p class="svelte-con17z">Loading comments...</p><!---->  <!--[!--><!--]--> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous" class="svelte-con17z"><!----><!----></div></div> <!--[!--><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1v99ir8 = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.DeSrvq4d.js"),
						import("../_app/immutable/entry/app.DUu0rXEm.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>

<!DOCTYPE html>
<html lang="en" data-theme="">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../../_app/immutable/assets/0.c0915e16.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/NoteGridStatusFilter.d210e4e4.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/13.1d26afe6.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/MDSveXNoteLayout.61812917.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.ed248b9e.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/scheduler.5beeadad.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/singletons.b84ca434.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/paths.ce9dafda.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/parse.bee59afc.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/control.f5b05b5f.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.f4cd938e.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.bfd99307.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.b8fa194d.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/each.e65d9593.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.45b59163.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/navigation.a10b8237.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/toast.9782a0ed.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/spread.8a54911c.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/13.7d225a1b.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/LoadNote.65e68a20.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/stores.54d9f105.js"><title>Resolving CORS errors in SvelteKit - Allan Deutsch</title><!-- HEAD_svelte-n5ip0u_START --><meta name="description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser."><meta property="og:title" content="Resolving CORS errors in SvelteKit"><meta property="og:type" content="article"><meta property="og:url" content="https://allandeutsch.com/notes/sveltekit-cors"><meta property="og:description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser."><meta property="og:locale" content="en_US"><meta property="twitter:card" content="summary"><meta property="twitter:url" content="https://allandeutsch.com"><meta property="twitter:title" content="Resolving CORS errors in SvelteKit"><meta property="twitter:description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser."><meta property="twitter:site" content="@AllanDeutsch"><meta property="twitter:creator" content="@AllanDeutsch"><link rel="canonical" href="https://allandeutsch.com/notes/sveltekit-cors"><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" data-svelte-h="svelte-bv2cpr"></script><!-- HEAD_svelte-n5ip0u_END -->
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
		<script src="https://www.penguinsight.com/thumbs.js" type="module"></script>
	</head>
	<body data-sveltekit-preload-data="hover" class="bg-base-100">
		<div style="display: contents">  <div class="toaster  svelte-jyff3d"> </div> <div class="navbar bg-base-100"><div class="navbar-start"><div class="dropdown"><button tabindex="0" class="btn-ghost btn sm:hidden" data-svelte-h="svelte-1h8jdop"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg></button> <ul tabindex="0" class="dropdown-content menu rounded-box menu-sm mt-3 w-52 bg-base-100 p-2 shadow"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li></ul></div> <a class="btn-ghost btn text-xl normal-case" href="/">Allan Deutsch</a></div> <div class="navbar-center hidden sm:flex"><ul class="menu menu-horizontal px-1 text-base"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li></ul></div> <div class="navbar-end"> <div class="h-8" data-svelte-h="svelte-b95tle"><a href="https://twitter.com/AllanDeutsch" class="group"><svg height="24" width="24" class="mr-1.5 inline transition-colors duration-300 group-hover:fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612"><path d="M612 116.258a250.714 250.714 0 01-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 01-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="mr-1.5 inline transition-colors duration-300 group-hover:fill-primary"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div> </div></div> <div class="p-1 sm:p-4"> <article class="note-container prose mb-8 max-w-full svelte-564mcj"><header class="w-full max-w-3xl self-center"><h1 class="mb-8 text-left text-4xl font-bold">Resolving CORS errors in SvelteKit</h1> <div class="text-md mb-12 mt-4 flex justify-between border-t border-t-neutral border-opacity-20 pt-1 text-base-content"><div><span class="pr-2" data-svelte-h="svelte-114jejz">üå±</span><span class="hidden sm:inline" data-svelte-h="svelte-1psjisz">Planted
				</span>March 27, 2024.
				</div> <div class="flex flex-col items-end"><div class="note__status seedling svelte-564mcj">seedling üå±</div> <div>1 minute read ‚è±</div></div></div></header>  <p data-svelte-h="svelte-1ilhl73">Web browsers try to protect the security of their users. One way they do this is by prohibiting scripts on one domain from interacting with resources on another domain by default. Sometimes as a developer, I <em>want</em> users to be able to interact with resources on my site from somewhere else:</p> <ul data-svelte-h="svelte-1hb2jnl"><li>Embedded media</li> <li>A widget or badge showing their data on another site</li> <li>Calling a public APIs from their browser (client-side)</li> <li>Sending analytics data to a 3rd-party analytics server</li></ul> <p data-svelte-h="svelte-1ac58jh">Requesting a resource on one site from another is called a ‚Äúcross-origin resource sharing‚Äù (CORS) request. While building <a href="https://penguinsight.com" rel="nofollow">Penguinsight</a> (it‚Äôs a tool that enables developers to provide feedback on developer documentation) I had just such a need. Imagine this scenario:</p> <blockquote data-svelte-h="svelte-yjnfph"><p>a developer is reading the documentation on using an API from one of my customers. One of the steps doesn‚Äôt work, and they want to use the <a href="https://penguinsight.com" rel="nofollow">Penguinsight</a> widget on the page to provide feedback. That feedback gets sent to the <a href="https://penguinsight.com" rel="nofollow">Penguinsight</a> server, which is on a <em>different</em> domain than the documentation site.</p></blockquote> <p data-svelte-h="svelte-1c2exvb">The user is requesting to access a resource (my API) <em>cross-origin</em>. Their browser makes a request to the Penguinsight server, but it‚Äôs not the <code>POST /api/feedback</code> request made by my tool. Before that happens, the browser needs to make a ‚Äúpreflight request‚Äù to make sure the server allows the actual request. This is done by requesting <code>OPTIONS /api/feedback</code>. The browser will only make the <code>POST</code> request if the server tells it that the request is allowed.</p> <!-- HTML_TAG_START --><pre class="shiki" style="background-color: #ffffff; color: #24292f" ts="true"><div class="language-id">ts</div><div class='code-container'><code><div class='line'><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">corsHeaders</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> &#123;</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Origin'</span><span style="color: #24292F">: </span><span style="color: #0A3069">'*'</span><span style="color: #24292F">,</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Methods'</span><span style="color: #24292F">: </span><span style="color: #0A3069">'OPTIONS,POST'</span><span style="color: #24292F">,</span></div><div class='line'><span style="color: #24292F">&#125;;</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-4z2jz4"><code>&#39;Access-Control-Allow-Origin&#39;</code> specifies which domains are allowed to <em>originate</em> requests for the resource. The wildcard, <code>&#39;*&#39;</code>, is used to denote that any site can request it. For a public API like on Penguinsight, this is the right option.</p> <p data-svelte-h="svelte-13165be"><code>&#39;Access-Control-Allow-Methods&#39;</code> gives the browser a comma-separated list of the allowed HTTP method verbs. <code>OPTIONS</code> is needed for the preflight request, and I also needed <code>POST</code> for the <code>/api/feedback</code> endpoint. You can add other HTTP methods here such as <code>GET</code>, <code>PUT</code>, or <code>PATCH</code>, but I didn‚Äôt need them for Penguinsight.</p> <p data-svelte-h="svelte-385ig1">To make sure my SvelteKit backend responds to CORS requests correctly, I wrote a <a href="https://kit.svelte.dev/docs/hooks#server-hooks" rel="nofollow">SvelteKit server hook</a> to add them. SvelteKit hooks can be used to run code on all incoming requests before handing them off to the SvelteKit router.</p> <!-- HTML_TAG_START --><pre class="shiki twoslash lsp" style="background-color: #ffffff; color: #24292f" ts="true"><div class="language-id">ts</div><div class='code-container'><code><div class='line dim'><span style="color: #CF222E">import</span><span style="color: #24292F"> </span><span style="color: #CF222E">type</span><span style="color: #24292F"> &#123; <data-lsp lsp='(alias) type Handle = (input: &#123;&#10;    event: RequestEvent;&#10;    resolve(event: RequestEvent, opts?: ResolveOptions): MaybePromise&lt;Response>;&#10;&#125;) => MaybePromise&lt;Response>&#10;import Handle' >Handle</data-lsp> &#125; </span><span style="color: #CF222E">from</span><span style="color: #24292F"> </span><span style="color: #0A3069">"@sveltejs/kit"</span><span style="color: #24292F">;</span></div><div class='line dim'>&nbsp;</div><div class='line dim'><span style="color: #CF222E">export</span><span style="color: #24292F"> </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE"><data-lsp lsp='const allowCORS: (&#123; event, resolve &#125;: &#123;&#10;    event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>;&#10;    resolve(event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>, opts?: ResolveOptions | undefined): MaybePromise&lt;...>;&#10;&#125;) => Promise&lt;...>' >allowCORS</data-lsp></span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> (</span><span style="color: #CF222E">async</span><span style="color: #24292F"> (&#123; </span><span style="color: #953800"><data-lsp lsp='(parameter) event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>' >event</data-lsp></span><span style="color: #24292F">, </span><span style="color: #953800"><data-lsp lsp='(parameter) resolve: (event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>, opts?: ResolveOptions | undefined) => MaybePromise&lt;Response>' >resolve</data-lsp></span><span style="color: #24292F"> &#125;) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> &#123;</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #6E7781">// 1. If the request isn&apos;t for a public API, don&apos;t add CORS headers</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE"><data-lsp lsp='const url: URL' >url</data-lsp></span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #CF222E">new</span><span style="color: #24292F"> </span><span style="color: #8250DF"><data-lsp lsp='var URL: new (url: string | URL, base?: string | URL | undefined) => URL' >URL</data-lsp></span><span style="color: #24292F">(<data-lsp lsp='(parameter) event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>' >event</data-lsp>.<data-lsp lsp='(property) RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>.request: Request' >request</data-lsp>.<data-lsp lsp='(property) Request.url: string' >url</data-lsp>);</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (</span><span style="color: #CF222E">!</span><span style="color: #24292F"><data-lsp lsp='const url: URL' >url</data-lsp>.<data-lsp lsp='(property) URL.pathname: string' >pathname</data-lsp>.</span><span style="color: #8250DF"><data-lsp lsp='(method) String.startsWith(searchString: string, position?: number | undefined): boolean' >startsWith</data-lsp></span><span style="color: #24292F">(</span><span style="color: #0A3069">&apos;/api&apos;</span><span style="color: #24292F">))</span></div><div class='line dim'><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #CF222E">await</span><span style="color: #24292F"> </span><span style="color: #8250DF"><data-lsp lsp='(parameter) resolve: (event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>, opts?: ResolveOptions | undefined) => MaybePromise&lt;Response>' >resolve</data-lsp></span><span style="color: #24292F">(<data-lsp lsp='(parameter) event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>' >event</data-lsp>);</span></div><div class='line dim'>&nbsp;</div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #6E7781">// 2. for options requests, just return the cors headers immediately.</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #6E7781">// Calling &#96;resolve(event)&#96; without an OPTIONS handler will throw an error.</span></div><div class='line highlight'><span style="color: #24292F">  </span><span style="color: #6E7781">// If that error isn&apos;t handled, the CORS headers won&apos;t be added.</span></div><div class='line highlight'><span style="color: #24292F">  </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (<data-lsp lsp='(parameter) event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>' >event</data-lsp>.<data-lsp lsp='(property) RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>.request: Request' >request</data-lsp>.<data-lsp lsp='(property) Request.method: string' >method</data-lsp> </span><span style="color: #CF222E">===</span><span style="color: #24292F"> </span><span style="color: #0A3069">&apos;OPTIONS&apos;</span><span style="color: #24292F">) &#123;</span></div><div class='line highlight'><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #CF222E">new</span><span style="color: #24292F"> </span><span style="color: #8250DF"><data-lsp lsp='var Response: new (body?: BodyInit | null | undefined, init?: ResponseInit | undefined) => Response' >Response</data-lsp></span><span style="color: #24292F">(</span><span style="color: #0550AE">null</span><span style="color: #24292F">, &#123; <data-lsp lsp='(property) ResponseInit.headers?: HeadersInit | undefined' >headers</data-lsp>: <data-lsp lsp='const corsHeaders: &#123;&#10;    &apos;Access-Control-Allow-Origin&apos;: string;&#10;    &apos;Access-Control-Allow-Methods&apos;: string;&#10;&#125;' >corsHeaders</data-lsp> &#125;);</span></div><div class='line dim'><span style="color: #24292F">  &#125;</span></div><div class='line dim'>&nbsp;</div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #6E7781">// 3. For other request methods, let the sveltekit router resolve it, then add the CORS headers</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE"><data-lsp lsp='const response: Response' >response</data-lsp></span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #CF222E">await</span><span style="color: #24292F"> </span><span style="color: #8250DF"><data-lsp lsp='(parameter) resolve: (event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>, opts?: ResolveOptions | undefined) => MaybePromise&lt;Response>' >resolve</data-lsp></span><span style="color: #24292F">(<data-lsp lsp='(parameter) event: RequestEvent&lt;Partial&lt;Record&lt;string, string>>, string | null>' >event</data-lsp>);</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #CF222E">for</span><span style="color: #24292F"> (</span><span style="color: #CF222E">const</span><span style="color: #24292F"> [</span><span style="color: #0550AE"><data-lsp lsp='const key: string' >key</data-lsp></span><span style="color: #24292F">, </span><span style="color: #0550AE"><data-lsp lsp='const value: string' >value</data-lsp></span><span style="color: #24292F">] </span><span style="color: #CF222E">of</span><span style="color: #24292F"> </span><span style="color: #0550AE"><data-lsp lsp='var Object: ObjectConstructor' >Object</data-lsp></span><span style="color: #24292F">.</span><span style="color: #8250DF"><data-lsp lsp='(method) ObjectConstructor.entries&lt;string>(o: &#123;&#10;    [s: string]: string;&#10;&#125; | ArrayLike&lt;string>): [string, string][] (+1 overload)' >entries</data-lsp></span><span style="color: #24292F">(<data-lsp lsp='const corsHeaders: &#123;&#10;    &apos;Access-Control-Allow-Origin&apos;: string;&#10;    &apos;Access-Control-Allow-Methods&apos;: string;&#10;&#125;' >corsHeaders</data-lsp>)) &#123;</span></div><div class='line dim'><span style="color: #24292F">    <data-lsp lsp='const response: Response' >response</data-lsp>.<data-lsp lsp='(property) Response.headers: Headers' >headers</data-lsp>.</span><span style="color: #8250DF"><data-lsp lsp='(method) Headers.set(name: string, value: string): void' >set</data-lsp></span><span style="color: #24292F">(<data-lsp lsp='const key: string' >key</data-lsp>, <data-lsp lsp='const value: string' >value</data-lsp>);</span></div><div class='line dim'><span style="color: #24292F">  &#125;</span></div><div class='line dim'><span style="color: #24292F">  </span><span style="color: #CF222E">return</span><span style="color: #24292F"> <data-lsp lsp='const response: Response' >response</data-lsp>;</span></div><div class='line dim'><span style="color: #24292F">&#125;) satisfies <data-lsp lsp='(alias) type Handle = (input: &#123;&#10;    event: RequestEvent;&#10;    resolve(event: RequestEvent, opts?: ResolveOptions): MaybePromise&lt;Response>;&#10;&#125;) => MaybePromise&lt;Response>&#10;import Handle' >Handle</data-lsp>;</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-ian9k9">This hook has 3 pieces:</p> <ol data-svelte-h="svelte-aq7ddu"><li>It checks if the requested path is under <code>/api</code>, the only Penguinsight resource I want to allow CORS access for. If not, it does nothing.</li> <li>If the request is a preflight <code>OPTIONS</code> request, it immediately returns success response with the headers specifying which types of requests allow CORS. I intentionally avoid any further sveltekit handling by returning without calling <code>resolve(event)</code></li> <li>For all other requests, I let SvelteKit route the request to a handler with <code>resolve(event)</code>, then add the CORS headers to the response that resulted from it before sending it back to the client.</li></ol> <p data-svelte-h="svelte-48ht6v">I‚Äôve run into CORS issues a few times and it always takes me hours to figure out what‚Äôs wrong. None of the resources I‚Äôve found did a good job explaining <em>why</em> CORS exists, how it works, or the relevant nuances of the framework in question. I‚Äôve tried to provide just enough detail on all of those that it makes sense. After finally narrowing it down to the smallest working solution, I wrote this note to document it for my future self and anyone else who needs to support CORS requests.</p> <h2 id="addendum" data-svelte-h="svelte-1u4m6r4"><a aria-hidden="true" tabindex="-1" href="#addendum"><span class="icon icon-link"></span></a><a href="#addendum" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Addendum</h2> <p data-svelte-h="svelte-1ge03i1">If you need to support authenticated requests, requests with specific <code>Content-Type</code>, or other header information, there are some additional CORS headers you can add to allow them. Here‚Äôs an example of a more permissive set of CORS headers:</p> <!-- HTML_TAG_START --><pre class="shiki" style="background-color: #ffffff; color: #24292f" ts="true"><div class="language-id">ts</div><div class='code-container'><code><div class='line'><span style="color: #CF222E">export</span><span style="color: #24292F"> </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">corsHeaders</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> &#123;</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Credentials'</span><span style="color: #24292F">: </span><span style="color: #0A3069">'true'</span><span style="color: #24292F">,</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Origin'</span><span style="color: #24292F">: </span><span style="color: #0A3069">'*'</span><span style="color: #24292F">,</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Methods'</span><span style="color: #24292F">: </span><span style="color: #0A3069">'OPTIONS,POST,GET,PUT,PATCH,DELETE'</span><span style="color: #24292F">,</span></div><div class='line'><span style="color: #24292F">  </span><span style="color: #0A3069">'Access-Control-Allow-Headers'</span><span style="color: #24292F">:</span></div><div class='line'><span style="color: #24292F">    </span><span style="color: #0A3069">'authorization, x-client-info, apikey, X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version'</span></div><div class='line'><span style="color: #24292F">&#125;;</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1uww94u">If any of those are not <em>needed</em> for your use case, I suggest not allowing them. Essentially these headers should be shrunk to the minimal set that works for your use case.</p> <div class="divider"></div> <aside class="prose"><h2 class="prose-h2:text-lg" data-svelte-h="svelte-128y7pj">Feedback</h2> <p data-svelte-h="svelte-171xzz7">Thanks for reading this, I hope it has helped you in some way. I&#39;d love it
			if you would share your feedback with my by using one of the buttons
			below. It only takes a second, and whether you love it or hate it, the
			feedback helps me write better content in the future!</p> <pi-thumb user="(anonymous)" path="notes/sveltekit-cors" team="d6101342-650f-443e-893a-0bcb31bd8da9"></pi-thumb> <p data-svelte-h="svelte-s9yh0w">If you&#39;re feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider"></div></aside></article>     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"></div>  
			
			<script>
				{
					__sveltekit_sgwbtd = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {"PUBLIC_SUPABASE_ANON_KEY":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFlb3ZmZXRyaXNyZnFpZWF0bXp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODcwNjM0NTYsImV4cCI6MjAwMjYzOTQ1Nn0.s9KXOQ0gDdl7e3lTUxdN5yfPI0rLZ-dSRMfEwoHhK00","PUBLIC_SUPABASE_URL":"https://aeovfetrisrfqieatmzw.supabase.co"}
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":{session:null,user:null},"uses":{}},null];

					Promise.all([
						import("../../_app/immutable/entry/start.ed248b9e.js"),
						import("../../_app/immutable/entry/app.f4cd938e.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 13],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>

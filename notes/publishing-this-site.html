<!doctype html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.DCVacgUG.css" rel="stylesheet">
		<link href="../_app/immutable/assets/NoteGridStatusFilter.XVDl0Kvs.css" rel="stylesheet">
		<link href="../_app/immutable/assets/MDSveXNoteLayout.CyYI4j1f.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.Dsy89llY.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.D9dVy7Sb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DvqknzhR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BrvgqOKF.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BOCtfefK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CMufJmNh.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.DP15y4Vy.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1FmrZbK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BMtht3uS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DeJ_mBX6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DhOaGKI3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CodHM6-c.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Sv_TBA-2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tqtBAqyL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DBhMLwmp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B8ys1oD7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CQvACQAz.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.t_NZDHT3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BmDftNyR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BaJv1Ckm.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DCbVyqWN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Xnr4kkBN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bwbv14AI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dv2HnFaC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/HlWhSox1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C932wzq6.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.yUi5ogUj.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/uiDjfure.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BIAIPjhi.js"><!--[--><meta name="description" content="An overview of how I avoided needing to copy+paste my notes into blogging software to publish them." class="svelte-de2ged"> <meta property="og:title" content="The publishing pipeline for allandeutsch.com" class="svelte-de2ged"> <meta property="og:type" content="article" class="svelte-de2ged"> <meta property="og:url" content="https://allandeutsch.com/notes/publishing-this-site" class="svelte-de2ged"> <meta property="og:description" content="An overview of how I avoided needing to copy+paste my notes into blogging software to publish them." class="svelte-de2ged"> <meta property="og:locale" content="en_US" class="svelte-de2ged"> <meta property="twitter:card" content="summary" class="svelte-de2ged"> <meta property="twitter:url" content="https://allandeutsch.com" class="svelte-de2ged"> <meta property="twitter:title" content="The publishing pipeline for allandeutsch.com" class="svelte-de2ged"> <meta property="twitter:description" content="An overview of how I avoided needing to copy+paste my notes into blogging software to publish them." class="svelte-de2ged"> <meta property="twitter:site" content="@AllanDeutsch" class="svelte-de2ged"> <meta property="twitter:creator" content="@AllanDeutsch" class="svelte-de2ged"> <link rel="canonical" href="https://allandeutsch.com/notes/publishing-this-site" class="svelte-de2ged"> <script type="module" src="https://docduck.dev/selection.js" class="svelte-de2ged"></script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" class="svelte-de2ged"></script><!--]--><!--[--><!--[--><meta name="theme-color" content="dark"><!--]--> <!----><script>(function setInitialMode({ defaultMode = "system", themeColors: themeColors2, darkClassNames: darkClassNames2 = ["dark"], lightClassNames: lightClassNames2 = [], defaultTheme = "", modeStorageKey: modeStorageKey2 = "mode-watcher-mode", themeStorageKey: themeStorageKey2 = "mode-watcher-theme" }) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem(modeStorageKey2) || defaultMode;
  const theme2 = localStorage.getItem(themeStorageKey2) || defaultTheme;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  if (light) {
    if (darkClassNames2.length)
      rootEl.classList.remove(...darkClassNames2);
    if (lightClassNames2.length)
      rootEl.classList.add(...lightClassNames2);
  } else {
    if (lightClassNames2.length)
      rootEl.classList.remove(...lightClassNames2);
    if (darkClassNames2.length)
      rootEl.classList.add(...darkClassNames2);
  }
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  if (theme2) {
    rootEl.setAttribute("data-theme", theme2);
    localStorage.setItem(themeStorageKey2, theme2);
  }
  localStorage.setItem(modeStorageKey2, mode);
})({"defaultMode":"system","themeColors":{"dark":"dark","light":"light"},"darkClassNames":["dark"],"lightClassNames":[],"defaultTheme":"","modeStorageKey":"mode-watcher-mode","themeStorageKey":"mode-watcher-theme"});</script><!----><!--]--><title>The publishing pipeline for allandeutsch.com - Allan Deutsch</title>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
	</head>
	<body
		data-sveltekit-preload-data="hover"
		data-sveltekit-preload-data="viewport"
		class="h-full min-h-[100vh] bg-base-100">
		<div style="display: contents"><!--[--><!--[--><!----><div class="h-full min-h-[100dvh]"><!--[!--><!--]--><!----> <div class="flex w-full items-center bg-base-100 p-2 print:hidden"><!----><!----><!--[!--><button class="px-4 sm:hidden" id="bits-36" aria-haspopup="menu" aria-expanded="false" data-state="closed" data-dropdown-menu-trigger="" type="button"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg> <span class="sr-only">Open navigation menu</span><!----></button><!--]--><!----><!----> <!----><!----><!--[!--><!--]--><!----><!----><!----><!----><!----><!----> <div class="w-1/2 px-4 text-xl font-semibold"><a href="/">Allan Deutsch</a></div> <div class="hidden shrink-0 sm:flex"><ul class="menu menu-horizontal px-1 text-base"><!--[--><!--[!--><li><a href="/">Home</a></li><!--]--><!--[!--><li><a href="/notes">Notes</a></li><!--]--><!--[!--><li><a href="/devlog">Devlog</a></li><!--]--><!--]--></ul></div> <div class="flex w-1/2 justify-end"><!--[!--><div><a href="https://twitter.com/AllanDeutsch" class="group"><span class="sr-only">Follow me on Twitter</span> <svg height="24" width="24" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612"><path d="M612 116.258a250.714 250.714 0 01-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 01-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><span class="sr-only">Follow me on GitHub</span> <svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div><!--]--></div></div><!----> <div class="h-full p-1 sm:p-4"><!----><docduck-feedback team="TKxfdiO22xOXIrW0c0Pfi" class="svelte-de2ged"></docduck-feedback> <div class="grid w-full grid-cols-[1fr_min(65ch,100%)_1fr] svelte-de2ged"><h1 class="col-start-2 col-end-3 text-left text-4xl font-bold svelte-de2ged" style="view-transition-name: title">The publishing pipeline for allandeutsch.com</h1></div> <article class="note-container prose mb-8 max-w-full px-2 svelte-de2ged" style="view-transition-name: article;"><header class="w-full max-w-3xl self-center svelte-de2ged"><div class="text-md border-t-neutral/20 text-base-content mt-4 mb-12 flex justify-between border-t pt-1 svelte-de2ged"><div class="svelte-de2ged"><span class="pr-2 svelte-de2ged">🌱</span><span class="hidden sm:inline svelte-de2ged">Planted</span>October 4, 2021. <!--[--><br class="svelte-de2ged">Last tended February 7, 2024.<!--]--></div> <div class="flex flex-col items-end svelte-de2ged"><div class="note__status budding svelte-de2ged">budding 🌿</div> <!--[--><div class="svelte-de2ged">6 minutes read ⏱</div><!--]--></div></div></header> <!----><p>Like any good PM, I opted to start from the ideal user experience. This was unusually easy since I am the only user; talk about putting the <em>personal</em> in personal computing!</p> <p>My ideal workflow for publishing is to author my notes in <a href="https://obsidian.md" rel="nofollow">Obsidian</a> on any device and control publishing them to my website using a frontmatter property in each note. Step by step, this looks something like:</p> <ol><li>I edit my notes locally on any device of my choice using Obsidian</li> <li>Sync notes across devices using automatic git backups</li> <li>I can add <code>publish: true</code> to any note’s frontmatter to <strong>opt-in</strong> to publishing the note (default to private)</li> <li>Git commits to my private notes repo triggers an automated workflow to build &amp; deploy notes opted-in to publishing</li></ol> <h2 id="structuring-the-build-pipeline"><a aria-hidden="true" tabindex="-1" href="#structuring-the-build-pipeline"><span class="icon icon-link"></span></a><a href="#structuring-the-build-pipeline" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Structuring the build pipeline</h2> <p>Because I want my notes to be private by default, they exist in their own private git repo. The SvelteKit code for this site is private, though I hope to open-source it one day. That leaves the site deployment, which is hosted using my GitHub account’s <a href="https://github.com/Masstronaut/Masstronaut.github.io" rel="nofollow">GitHub Pages repo</a> and pushed to automatically by my GitHub Actions workflow.</p> <p>Here’s an overview of what happens in the CI workflow:</p> <ol><li>Commits to either the private notes or private site code repos trigger a build</li> <li>The build action pulls the private notes and processes them for publishing: <ol><li>A python script deletes all notes not opted-in for publishing</li> <li>The remaining notes are run through <a href="https://github.com/zoni/obsidian-export" rel="nofollow">obsidian-export</a> to convert them from Obsidian markdown to <a href="https://commonmark.org/" rel="nofollow">Commonmark</a></li></ol></li> <li>The site’s SvelteKit code is pulled from another repo</li> <li>The processed notes are dumped into a <code>content</code> folder</li> <li>The SvelteKit site is built using the <a href="https://www.npmjs.com/package/@sveltejs/adapter-static" rel="nofollow">static adapter</a></li> <li>The completed build is pushed to my GitHub Pages repo</li></ol> <p>This entire process takes around 2 minutes from start to finish. I’ve noticed that sometimes GitHub takes another minute or two to distribute the latest build across the Pages CDN.</p> <h2 id="initiating-builds"><a aria-hidden="true" tabindex="-1" href="#initiating-builds"><span class="icon icon-link"></span></a><a href="#initiating-builds" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Initiating builds</h2> <p>My build pipeline is fully automated, but that’s not the only piece. I generally don’t need to manually author commits, either. While I generally avoid committing broken code, notes don’t really have a broken state that would fail to compile. A half-written note is in a valid state for backing up to git, so notes are a great candidate for automatic git commits.</p> <p>I achieve automated commits in 2 ways, depending on the device. On a computer, I use the <a href="https://github.com/denolehov/obsidian-git" rel="nofollow">obisidian-git</a> plugin. It’s easy to set up and works great. I have it configured to automatically backup my notes to git every 30 minutes if there are any changes, and it provides a command to manually trigger a backup too.</p> <p>On mobile &amp; tablet devices, though, it’s not so great. iOS and Android lack a native git client for the plugin to use, so it ships with a JS implementation of git that is very slow. I didn’t like this approach, so opted for a different workflow.</p> <p>On mobile &amp; tablet, I use a combination of <a href="https://workingcopy.app/" rel="nofollow">Working Copy</a> as a git client and Apple Shortcuts to operate it. I have 2 shortcuts:</p> <ol><li>A button shortcut that replaces my Obsidian app icon. When tapped, it: <ol><li>Pulls the git repo containing my notes, then</li> <li>Launches obsidian once the pull is completed</li></ol></li> <li>An automated shortcut that pushes all changes to my notes repo when I leave the Obsidian app</li></ol> <p>I’ve found this setup makes it extremely easy to get content published and shared with people on demand.</p> <h2 id="specifying-publishing-details-for-notes"><a aria-hidden="true" tabindex="-1" href="#specifying-publishing-details-for-notes"><span class="icon icon-link"></span></a><a href="#specifying-publishing-details-for-notes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Specifying publishing details for notes</h2> <p>The last detail worth covering is how I specify metadata for published notes. TL;DR: I use frontmatter.</p> <p>All the metadata on this and other notes is specified in the frontmatter. <a href="/notes/slugs-make-links-readable">Slugs make links readable</a>, so I specify my slugs in the frontmatter. For this note that frontmatter is <code>slug: publishing-this-site</code>. Really simple! I do similar for the created date, last modified date, title, description, etc. I use <a href="https://mdsvex.pngwn.io/" rel="nofollow">mdsvex</a> to process my markdown into svelte components, and it makes the frontmatter metadata available so I can easily use it when rendering the page.</p> <p>Hopefully this overview inspires you to build your own publishing pipeline and put the <em>personal</em> back in <em>personal computing</em>. If you have any questions/comments/feedback, please <a href="https://twitter.com/AllanDeutsch" rel="nofollow">reach out to me on Twitter</a>!</p><!----><!----> <div class="divider svelte-de2ged"></div> <aside class="prose svelte-de2ged"><p class="svelte-de2ged">If you're feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider svelte-de2ged"></div></aside></article> <!----><p class="svelte-de2ged">Loading comments...</p><!---->  <!--[--><div class="flex w-full flex-col items-center"><h2 class="my-6 self-center text-5xl text-base-content">Linked notes</h2> <!--[!--><!--]--> <div class="col-auto grid w-full grid-cols-[repeat(auto-fill,_minmax(300px,_1fr))] justify-items-center gap-3"><!--[!--><!--[--><a style="--statusColor: 85, 40%, 55%;" href="/notes/slugs-make-links-readable" class="m-4 flex w-full min-w-[300px] max-w-[450px] flex-1 basis-80 text-inherit no-underline"><article class="group flex h-64 w-full flex-col justify-between border border-solid border-base-300 bg-base-100 px-10 py-8 text-base-content text-opacity-80 transition-all duration-200 hover:border-[hsl(var(--statusColor))] hover:text-opacity-100 hover:shadow-xl hover:shadow-[hsla(var(--statusColor),.25)] active:-translate-y-1 active:scale-[1.01] active:shadow-md svelte-15ajeer"><section class="notecontent"><header class="svelte-15ajeer"><h1 class="line-clamp-2 h-16 text-lg svelte-15ajeer">Slugs make links readable</h1></header> <!--[--><p class="mt-3 line-clamp-3 h-[4.5em] leading-[1.5em] transition-all duration-200">Special characters aren't valid in URLs, so custom slugs are used to make links easier to read.</p><!--]--></section> <section class="notemetadata border-t border-t-neutral-content border-opacity-60 pt-1 text-right text-sm svelte-15ajeer"><div class="date min-w-[12ch] text-opacity-50 svelte-15ajeer">Feb 4, 2024</div> <div class="min-w-[12ch] capitalize text-[hsl(var(--statusColor))] svelte-15ajeer">seedling 🌱</div></section></article></a><!--]--><!--]--></div></div><!--]--> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous" class="svelte-de2ged"><!----><!----></div></div> <!--[!--><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1tyviz = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.D9dVy7Sb.js"),
						import("../_app/immutable/entry/app.DP15y4Vy.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>

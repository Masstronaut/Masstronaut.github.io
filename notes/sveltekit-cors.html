<!doctype html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/x-icon" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/TronHeading.5tpDtCQQ.css" rel="stylesheet">
		<link href="../_app/immutable/assets/NoteGridStatusFilter.DILY5wnt.css" rel="stylesheet">
		<link href="../_app/immutable/assets/0.DtgXcjFx.css" rel="stylesheet">
		<link href="../_app/immutable/assets/GlassEffect.-7RDajzJ.css" rel="stylesheet">
		<link href="../_app/immutable/assets/MDSveXNoteLayout.uVkcqMJb.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.BpKNQpLP.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.WvV1SPpB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CVslvaPJ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BaUsH2B2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BxJAsQqh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CUR-fCC-.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BH-rM3nF.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DbQGNtFu.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.BT82jKLA.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dp1pzeXC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/jgUhYS-4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bzak7iHL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/By-kdEGs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C9WOoZP2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/v2Y_1hmh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DRDuvXTo.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.D9tNYjn5.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DvJAWxb3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DoS267UE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BAsWuAqS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D3UsDQpB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/gnU0ypJ3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DwmU0p8V.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BHkjH7s_.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.BUsO9LWN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/n0aWE4F2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/P0C75NQj.js"><!--[--><meta name="description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser." class="svelte-12xwe57"/> <meta property="og:title" content="Resolving CORS errors in SvelteKit" class="svelte-12xwe57"/> <meta property="og:type" content="article" class="svelte-12xwe57"/> <meta property="og:url" content="https://allandeutsch.com/notes/sveltekit-cors" class="svelte-12xwe57"/> <meta property="og:description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser." class="svelte-12xwe57"/> <meta property="og:locale" content="en_US" class="svelte-12xwe57"/> <meta property="twitter:card" content="summary" class="svelte-12xwe57"/> <meta property="twitter:url" content="https://allandeutsch.com" class="svelte-12xwe57"/> <meta property="twitter:title" content="Resolving CORS errors in SvelteKit" class="svelte-12xwe57"/> <meta property="twitter:description" content="Cross-origin resource sharing requests let a user access resources on one site from another, but only if the server performs the secret CORS handshake with the browser." class="svelte-12xwe57"/> <meta property="twitter:site" content="@AllanDeutsch" class="svelte-12xwe57"/> <meta property="twitter:creator" content="@AllanDeutsch" class="svelte-12xwe57"/> <link rel="canonical" href="https://allandeutsch.com/notes/sveltekit-cors" class="svelte-12xwe57"/> <script type="module" src="https://docduck.dev/selection.js" class="svelte-12xwe57"></script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" class="svelte-12xwe57"></script><!--]--><!--[--><!--[--><meta name="theme-color" content="dark"/><!--]--> <!----><script>(function setInitialMode({ defaultMode = "system", themeColors: themeColors2, darkClassNames: darkClassNames2 = ["dark"], lightClassNames: lightClassNames2 = [], defaultTheme = "", modeStorageKey: modeStorageKey2 = "mode-watcher-mode", themeStorageKey: themeStorageKey2 = "mode-watcher-theme" }) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem(modeStorageKey2) || defaultMode;
  const theme2 = localStorage.getItem(themeStorageKey2) || defaultTheme;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  if (light) {
    if (darkClassNames2.length)
      rootEl.classList.remove(...darkClassNames2);
    if (lightClassNames2.length)
      rootEl.classList.add(...lightClassNames2);
  } else {
    if (lightClassNames2.length)
      rootEl.classList.remove(...lightClassNames2);
    if (darkClassNames2.length)
      rootEl.classList.add(...darkClassNames2);
  }
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  if (theme2) {
    rootEl.setAttribute("data-theme", theme2);
    localStorage.setItem(themeStorageKey2, theme2);
  }
  localStorage.setItem(modeStorageKey2, mode);
})({"defaultMode":"system","themeColors":{"dark":"dark","light":"light"},"darkClassNames":["dark"],"lightClassNames":[],"defaultTheme":"","modeStorageKey":"mode-watcher-mode","themeStorageKey":"mode-watcher-theme"});</script><!----><!--]--><title>Resolving CORS errors in SvelteKit - Allan Deutsch</title>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
	</head>
	<body
		data-sveltekit-preload-data="hover"
		data-sveltekit-preload-data="viewport"
		class="bg-background h-full min-h-[100vh]">
		<div style="display: contents"><!--[--><!--[--><!----><div class="h-full min-h-[100dvh]"><canvas style="position: fixed; height: 100vh; width: 100vw; margin: 0; z-index: -101;"></canvas> <canvas style="position: fixed; height: 100vh; width: 100vw; margin: 0; z-index: -100;"></canvas><!----> <!--[!--><!--]--><!----> <div class="relative flex w-full items-center p-2 print:hidden"><div class="backdrop svelte-msju1h"></div> <div class="backdrop-edge svelte-msju1h"></div><!----> <!----><!----><!--$s1--><!--[!--><button class="px-4 sm:hidden" id="bits-s1" aria-haspopup="menu" aria-expanded="false" data-state="closed" data-dropdown-menu-trigger="" type="button"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg> <span class="sr-only">Open navigation menu</span><!----></button><!--]--><!----><!----> <!----><!----><!--[!--><!--]--><!----><!----><!----><!----><!----><!----> <div class="w-1/2 px-4 text-xl font-semibold text-nowrap"><a href="/"><span class="retrotext text-muted font-bold uppercase svelte-rt023y" style="--color: hsl(85, 45%, 55%); --scalar: 0; --hoveredScalar: 0.1; --letters: 13; --duration: 0.3s;"><!--[--><span class="word inline-block svelte-rt023y"><!--[--><span class="letter relative svelte-rt023y" style="--letter:0">A<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">A</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">A</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:1">l<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">l</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:2">l<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">l</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">l</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:3">a<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">a</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">a</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:4">n<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">n</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">n</span><!--]--></span><!--]--><!--[--><span class="space svelte-rt023y">¬†</span><!--]--></span><span class="word inline-block svelte-rt023y"><!--[--><span class="letter relative svelte-rt023y" style="--letter:6">D<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">D</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">D</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:7">e<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">e</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">e</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:8">u<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">u</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">u</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:9">t<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">t</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">t</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:10">s<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">s</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">s</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:11">c<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">c</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">c</span><!--]--></span><span class="letter relative svelte-rt023y" style="--letter:12">h<!--[--><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 0 * var(--scalar)); --index: 0;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 1 * var(--scalar)); --index: 1;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 2 * var(--scalar)); --index: 2;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 3 * var(--scalar)); --index: 3;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 4 * var(--scalar)); --index: 4;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 5 * var(--scalar)); --index: 5;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 6 * var(--scalar)); --index: 6;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 7 * var(--scalar)); --index: 7;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 8 * var(--scalar)); --index: 8;">h</span><span class="absolute select-none svelte-rt023y" style="--inset: calc(1 - 9 * var(--scalar)); --index: 9;">h</span><!--]--></span><!--]--><!--[!--><!--]--></span><!--]--></span><!----></a></div> <div class="hidden shrink-0 sm:flex"><ul class="inline-flex w-fit flex-row px-1 text-base"><!--[--><!--[!--><li><a href="/" class="px-3 text-lg"><span class="svelte-1p7f3ow"><!---->Home<!----></span><!----></a></li><!--]--><!--[!--><li><a href="/notes" class="px-3 text-lg"><span class="svelte-1p7f3ow"><!---->Notes<!----></span><!----></a></li><!--]--><!--[!--><li><a href="/devlog" class="px-3 text-lg"><span class="svelte-1p7f3ow"><!---->Devlog<!----></span><!----></a></li><!--]--><!--]--></ul></div> <div class="hidden w-1/2 justify-end min-[400px]:flex"><!--[!--><div><a href="https://linkedin.com/in/allandeutsch" class="group"><span class="sr-only">connect with me on LinkedIn</span> <svg class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300" aria-hidden="true" role="img" width="24" height="24" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M34 2.5v29a2.5 2.5 0 01-2.5 2.5h-29A2.5 2.5 0 010 31.5v-29A2.5 2.5 0 012.5 0h29A2.5 2.5 0 0134 2.5zM10 13H5v16h5zm.45-5.5a2.88 2.88 0 00-2.86-2.9H7.5a2.9 2.9 0 000 5.8 2.88 2.88 0 002.95-2.81zM29 19.28c0-4.81-3.06-6.68-6.1-6.68a5.7 5.7 0 00-5.06 2.58h-.14V13H13v16h5v-8.51a3.32 3.32 0 013-3.58h.19c1.59 0 2.77 1 2.77 3.52V29h5z"></path></svg></a> <a href="https://bsky.app/profile/allandeutsch.com" class="group"><span class="sr-only">Follow me on Bluesky</span> <svg height="24" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300"><title>Bluesky</title><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><span class="sr-only">Follow me on GitHub</span> <svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="fill-muted-foreground group-hover:fill-primary mr-1.5 inline transition-colors duration-300"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div><!--]--></div></div><!----> <div class="h-full p-1 sm:p-4"><!----><docduck-feedback team="TKxfdiO22xOXIrW0c0Pfi" class="svelte-12xwe57"></docduck-feedback> <div class="grid w-full grid-cols-[1fr_min(65ch,100%)_1fr] svelte-12xwe57"><h1 class="col-start-2 col-end-3 text-left text-4xl font-bold svelte-12xwe57" style="view-transition-name: title">Resolving CORS errors in SvelteKit</h1></div> <article class="note-container dark:prose-invert prose mb-8 max-w-full px-2 svelte-12xwe57"><header class="w-full max-w-3xl self-center svelte-12xwe57"><div class="text-md border-t-neutral/20 text-muted-foreground mt-4 mb-12 flex justify-between border-t pt-1 svelte-12xwe57"><div class="svelte-12xwe57"><span class="pr-2 svelte-12xwe57">üå±</span><span class="hidden sm:inline svelte-12xwe57">Planted</span> March 27, 2024. <!--[--><br class="svelte-12xwe57"/>Last tended March 30, 2024.<!--]--></div> <div class="flex flex-col items-end svelte-12xwe57"><div class="note__status budding svelte-12xwe57">budding üåø</div> <!--[--><div class="svelte-12xwe57">7 minutes read ‚è±</div><!--]--></div></div></header> <!----><p>Web browsers try to protect the security of their users. One way they do this is by prohibiting scripts on one domain from interacting with resources on another domain by default. Sometimes as a developer, I <em>want</em> users to be able to interact with resources on my site from somewhere else:</p> <ul><li>Embedded media</li> <li>A widget or badge showing their data on another site</li> <li>Calling a public APIs from their browser (client-side)</li> <li>Sending analytics data to a 3rd-party analytics server</li></ul> <p>Requesting a resource on one site from another is called a ‚Äúcross-origin resource sharing‚Äù (CORS) request. While building <a href="https://penguinsight.com" rel="nofollow">Penguinsight</a> (it‚Äôs a tool that enables developers to provide feedback on developer documentation) I had just such a need. Imagine this scenario:</p> <blockquote><p>a developer is reading the documentation on using an API from one of my customers. One of the steps doesn‚Äôt work, and they want to use the Penguinsight widget on the page to provide feedback. That feedback gets sent to the Penguinsight server, which is on a <em>different</em> domain than the documentation site.</p></blockquote> <p>The user is requesting to access a resource (my API) <em>cross-origin</em>. Their browser makes a request to the Penguinsight server, but it‚Äôs not the <code>POST /api/feedback</code> request made by my tool. Before that happens, the browser needs to make a ‚Äúpreflight request‚Äù to make sure the server allows the actual request. This is done by requesting <code>OPTIONS /api/feedback</code>. The browser will only make the <code>POST</code> request if the server tells it that the request is allowed.</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" data-tsplay="https://typescriptlang.org/play/#code/MYewdgzgLgBKBOEASBTAhgExYmBeGA3gFAwwDkAgsMChBALQDC4U8IANvRe+yAO70A8vACWAcxFgyALnIAqMgBoS5KjTpMWbTt14CAsiigALEBggzyggAoAVAJKCAcgGVF1wS9tKiAXwDcQA"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">corsHeaders</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">*</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Methods</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">OPTIONS,POST</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">const corsHeaders = &#123;
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Methods': 'OPTIONS,POST',
&#125;;</pre><!----> <p><code>'Access-Control-Allow-Origin'</code> specifies which domains are allowed to <em>originate</em> requests for the resource. The wildcard, <code>'*'</code>, is used to denote that any site can request it. For a public API like on <a href="https://penguinsight.com" rel="nofollow">Penguinsight</a>, this is the right option.</p> <p><code>'Access-Control-Allow-Methods'</code> gives the browser a comma-separated list of the allowed HTTP method verbs. <code>OPTIONS</code> is needed for the preflight request, and I also needed <code>POST</code> for the <code>/api/feedback</code> endpoint. You can add other HTTP methods here such as <code>GET</code>, <code>PUT</code>, or <code>PATCH</code>, but I didn‚Äôt need them for Penguinsight.</p> <p>To make sure my SvelteKit backend responds to CORS requests correctly, I wrote a <a href="https://kit.svelte.dev/docs/hooks#server-hooks" rel="nofollow">SvelteKit server hook</a> to add them. SvelteKit hooks can be used to run code on all incoming requests before handing them off to the SvelteKit router.</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark twoslash lsp" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]" data-tsplay="https://typescriptlang.org/play/#code/PTAEAEDMEsBsFMB2BDAtvAXKZtYHsB3AYQHkAlAZQDoALPPAayoBcBnAKAGM9FXnRuAJ1YAJeMgAm8YaAC8oAN7tQoAOQBBTp3itWAWiI9mgvLD3rchPSUHQA5tESqsqgFSqANMrWbtug0YmZhb4BHoAsvDMdBKszmokAAoAKgCSJAByFB6JJBTJnuwAvgDc7CCgelWcAK7MVXrs0KgADniC-MwAni3wiqAiyIgSCKBFoJAmqKAAROCsAG7wsMzwAFaswAzQzDNl7PAAHm0dAjx82JbE5BRyoAAUyKxdiJwPCqDwS4jMHqCCOlMSzGAEo5AA+RTeCoARiooFSkFA0T6AIAjjUdPxoKwnPxIO1sKAWjUAEawaBvdSJVJ-CQ8VT8SQSUCkSigGjiKTCbzcXj8GqCWB3RDwAigACqZAAMvcvkhmFR0Zi+FRBbAQWUVNAkfcAITqqgtZDRFDoKh8ZAdVgAdR2NHuqmAyBa0FUIJB3hUAOYgsQ2AIyB2-0BsCWcu+zE17GhYAATPCCYJQHgWsxoOcQxisaw-msahcfX7kZyzjJOZJpKxQM10BJoCbll0qLHWTgKYg7KAAAYA1hA+ARhUg7ugAj2vB1bD+pJpTK3GhDEbSMdwYXREzioafQQmQQtlQVRElk07vc13GMjlLhASP4o1k3Dlcqtjhn8Ul9ZnwCQHmu6+UfiVeBs1VdBojwFlZGghIUnSLJ3ShFRvSiYtRXFMgdDaXhB0QGpcD+D4K25VgsCEUQXxkIpoxUIoY0PMAAGZ4QAMUJPAUWTZUsVAcCYlzUAEE6UtFmWVZtn4Ew6hXPsBxrX4SyQbAJBZB82QXSiOBUPlCyw84+nkZBA2DWSw0HQCoy1CZCXuHT+AAbQYeAuj+BYcExABdFMkRIUk1ngThFQVWwdFs9oKMrYQPSQ5C+2w1h4FoTSLSie4nJc0A3NgTEaLGbwi0Ef04v0spqNAVgTRxGAdAGG94BKIA"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#1E754F;--shiki-dark:#4D9375"> type</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Handle</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">input</span><span style="color:#999999;--shiki-dark:#666666">: &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">    resolve</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">>;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#2E8F82;--shiki-dark:#5DA994"> MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></span></code></pre></code><div class="twoslash-popup-docs">The [&#96;handle&#96;](https://svelte.dev/docs/kit/hooks#Server-hooks-handle) hook runs every time the SvelteKit server receives a [request](https://svelte.dev/docs/kit/web-standards#Fetch-APIs-Request) and
determines the [response](https://svelte.dev/docs/kit/web-standards#Fetch-APIs-Response).
It receives an &#96;event&#96; object representing the request and a function called &#96;resolve&#96;, which renders the route and generates a &#96;Response&#96;.
This allows you to modify response headers or bodies, or bypass SvelteKit entirely (for implementing routes programmatically, for example).</div></span>Handle</span></span><span style="color:#999999;--shiki-dark:#666666"> &#125;</span><span style="color:#1E754F;--shiki-dark:#4D9375"> from</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">@sveltejs/kit</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">export</span><span style="color:#AB5959;--shiki-dark:#CB7676"> const </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#59873A;--shiki-dark:#80A665">allowCORS</span><span style="color:#999999;--shiki-dark:#666666">: (&#123; </span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">resolve</span><span style="color:#999999;--shiki-dark:#666666"> &#125;: &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">    resolve</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">>;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Promise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></span></code></pre></code></span>allowCORS</span></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">async </span><span style="color:#999999;--shiki-dark:#666666">(&#123;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">event</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>event</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">resolve</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#B07D48;--shiki-dark:#BD976A"> MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>resolve</span></span><span style="color:#999999;--shiki-dark:#666666"> &#125;)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // 1. If the request isn't for a public API, don't add CORS headers</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">  const </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">url</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">URL</span></code></span>url</span></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">URL</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#1E754F;--shiki-dark:#4D9375">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">url</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">URL</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">base</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">URL</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">URL</span></code><div class="twoslash-popup-docs">The **&#96;URL&#96;** interface is used to parse, construct, normalize, and encode URL.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/URL)</div></span>URL</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">event</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>event</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">>.</span><span style="color:#B07D48;--shiki-dark:#BD976A">request</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">Request</span></code><div class="twoslash-popup-docs">The original request object.</div></span>request</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">Request</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">url</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span></code><div class="twoslash-popup-docs">The **&#96;url&#96;** read-only property of the Request interface contains the URL of the request.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/Request/url)</div></span>url</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  if</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">!</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">url</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">URL</span></code></span>url</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">URL</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">pathname</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span></code><div class="twoslash-popup-docs">The **&#96;pathname&#96;** property of the URL interface represents a location in a hierarchical structure.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/URL/pathname)</div></span>pathname</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">String</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">startsWith</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">searchString</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> position</span><span style="color:#AB5959;--shiki-dark:#CB7676">?:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> number</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">boolean</span></code><div class="twoslash-popup-docs">Returns true if the sequence of elements of searchString converted to a String is the
same as the corresponding elements of this object (converted to a String) starting at
position. Otherwise returns false.</div></span>startsWith</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">/api</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:#1E754F;--shiki-dark:#4D9375"> await</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">resolve</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#B07D48;--shiki-dark:#BD976A"> MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>resolve</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">event</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>event</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // 2. for options requests, just return the cors headers immediately.</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // Calling &#96;resolve(event)&#96; without an OPTIONS handler will throw an error.</span></span>
<span class="line highlighted"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // If that error isn't handled, the CORS headers won't be added.</span></span>
<span class="line highlighted"><span style="color:#1E754F;--shiki-dark:#4D9375">  if</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">event</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>event</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">>.</span><span style="color:#B07D48;--shiki-dark:#BD976A">request</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">Request</span></code><div class="twoslash-popup-docs">The original request object.</div></span>request</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">Request</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">method</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span></code><div class="twoslash-popup-docs">The **&#96;method&#96;** read-only property of the &#96;POST&#96;, etc.) A String indicating the method of the request.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/Request/method)</div></span>method</span></span><span style="color:#AB5959;--shiki-dark:#CB7676"> === </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">OPTIONS</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line highlighted"><span style="color:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Response</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#1E754F;--shiki-dark:#4D9375">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">body</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">BodyInit</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#AB5959;--shiki-dark:#CB7676">null</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">init</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResponseInit</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span></code><div class="twoslash-popup-docs">The **&#96;Response&#96;** interface of the Fetch API represents the response to a request.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/Response)</div></span>Response</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">null</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#999999;--shiki-dark:#666666"> &#123; </span><span style="color:#998418;--shiki-dark:#B8A965"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">ResponseInit</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">headers</span><span style="color:#AB5959;--shiki-dark:#CB7676">?:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> HeadersInit</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> undefined</span></code></span>headers</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">corsHeaders</span><span style="color:#999999;--shiki-dark:#666666">: &#123;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Methods</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>corsHeaders</span></span><span style="color:#999999;--shiki-dark:#666666"> &#125;);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">  &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // 3. For other request methods, let the sveltekit router resolve it, then add the CORS headers</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">  const </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">response</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span></code></span>response</span></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#1E754F;--shiki-dark:#4D9375"> await</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">resolve</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#B07D48;--shiki-dark:#BD976A"> MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>resolve</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">event</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">>,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#AB5959;--shiki-dark:#CB7676"> null</span><span style="color:#999999;--shiki-dark:#666666">></span></code></span>event</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  for</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">key</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span></code></span>key</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">value</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span></code></span>value</span></span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> of </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Object</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ObjectConstructor</span></code><div class="twoslash-popup-docs">Provides functionality common to all JavaScript objects.</div></span>Object</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">ObjectConstructor</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">entries</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">>(</span><span style="color:#B07D48;--shiki-dark:#BD976A">o</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#999999;--shiki-dark:#666666">&#123;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    [</span><span style="color:#B07D48;--shiki-dark:#BD976A">s</span><span style="color:#998418;--shiki-dark:#B8A965">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">]: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> ArrayLike</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">>)</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span><span style="color:#999999;--shiki-dark:#666666">][]</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre></code><div class="twoslash-popup-docs">Returns an array of key/values of the enumerable own properties of an object</div><div class="twoslash-popup-docs twoslash-popup-docs-tags"><span class="twoslash-popup-docs-tag"><span class="twoslash-popup-docs-tag-name">@param</span><span class="twoslash-popup-docs-tag-value">o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.</span></span></div></span>entries</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">corsHeaders</span><span style="color:#999999;--shiki-dark:#666666">: &#123;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Methods</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>corsHeaders</span></span><span style="color:#999999;--shiki-dark:#666666">))</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">response</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span></code></span>response</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">Response</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">headers</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">Headers</span></code><div class="twoslash-popup-docs">The **&#96;headers&#96;** read-only property of the with the response.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/Response/headers)</div></span>headers</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#B07D48;--shiki-dark:#BD976A">Headers</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">set</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">name</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> value</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#B07D48;--shiki-dark:#BD976A">string</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">: </span><span style="color:#AB5959;--shiki-dark:#CB7676">void</span></code><div class="twoslash-popup-docs">The **&#96;set()&#96;** method of the Headers interface sets a new value for an existing header inside a &#96;Headers&#96; object, or adds the header if it does not already exist.

[MDN Reference](https://developer.mozilla.org/docs/Web/API/Headers/set)</div></span>set</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">key</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span></code></span>key</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">value</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span></code></span>value</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">  &#125;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  return</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#B07D48;--shiki-dark:#BD976A">response</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span></code></span>response</span></span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;)</span><span style="color:#1E754F;--shiki-dark:#4D9375"> satisfies</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> Handle</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">input</span><span style="color:#999999;--shiki-dark:#666666">: &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">    resolve</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">event</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">RequestEvent</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">opts</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ResolveOptions</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">>;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#2E8F82;--shiki-dark:#5DA994"> MaybePromise</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">Response</span><span style="color:#999999;--shiki-dark:#666666">></span></span></code></pre></code><div class="twoslash-popup-docs">The [&#96;handle&#96;](https://svelte.dev/docs/kit/hooks#Server-hooks-handle) hook runs every time the SvelteKit server receives a [request](https://svelte.dev/docs/kit/web-standards#Fetch-APIs-Request) and
determines the [response](https://svelte.dev/docs/kit/web-standards#Fetch-APIs-Response).
It receives an &#96;event&#96; object representing the request and a function called &#96;resolve&#96;, which renders the route and generates a &#96;Response&#96;.
This allows you to modify response headers or bodies, or bypass SvelteKit entirely (for implementing routes programmatically, for example).</div></span>Handle</span></span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">// @filename: allowCORS.hook.ts
const corsHeaders = &#123;
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Methods': 'OPTIONS,POST',
&#125;;
// ---cut---
import type &#123; Handle &#125; from "@sveltejs/kit";

export const allowCORS = (async (&#123; event, resolve &#125;) =&gt; &#123;
  // 1. If the request isn't for a public API, don't add CORS headers
  const url = new URL(event.request.url);
  if (!url.pathname.startsWith('/api'))
    return await resolve(event);

  // 2. for options requests, just return the cors headers immediately.
  // Calling &#96;resolve(event)&#96; without an OPTIONS handler will throw an error.
  // If that error isn't handled, the CORS headers won't be added.
  if (event.request.method === 'OPTIONS') &#123;
    return new Response(null, &#123; headers: corsHeaders &#125;);
  &#125;

  // 3. For other request methods, let the sveltekit router resolve it, then add the CORS headers
  const response = await resolve(event);
  for (const [key, value] of Object.entries(corsHeaders)) &#123;
    response.headers.set(key, value);
  &#125;
  return response;
&#125;) satisfies Handle;</pre><!----> <p>This hook has 3 pieces:</p> <ol><li>It checks if the requested path is under <code>/api</code>, the only Penguinsight resource I want to allow CORS access for. If not, it does nothing.</li> <li>If the request is a preflight <code>OPTIONS</code> request, it immediately returns success response with the headers specifying which types of requests allow CORS. I intentionally avoid any further sveltekit handling by returning without calling <code>resolve(event)</code></li> <li>For all other requests, I let SvelteKit route the request to a handler with <code>resolve(event)</code>, then add the CORS headers to the response that resulted from it before sending it back to the client.</li></ol> <p>I‚Äôve run into CORS issues a few times and it always takes me hours to figure out what‚Äôs wrong. None of the resources I‚Äôve found did a good job explaining <em>why</em> CORS exists, how it works, or the relevant nuances of the framework in question. I‚Äôve tried to provide just enough detail on all of those that it makes sense. After finally narrowing it down to the smallest working solution, I wrote this note to document it for my future self and anyone else who needs to support CORS requests.</p> <!----><h2 id="troubleshooting-other-cors-issues" class="heading-wrapper svelte-1j9ilu2"><button class="link-icon svelte-1j9ilu2" aria-label="Copy link to heading"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-link"><!--[--><!----><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"><!----></path><!----><!----><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"><!----></path><!----><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!----> <!--[!--><!--]--></button> <a href="#troubleshooting-other-cors-issues" class="heading-link svelte-1j9ilu2"><!---->Troubleshooting other CORS issues<!----><!----></a><!----></h2><!----><!----> <!----><h3 id="invalid-preflight-options-response---308-redirect" class="heading-wrapper svelte-1j9ilu2"><button class="link-icon svelte-1j9ilu2" aria-label="Copy link to heading"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-link"><!--[--><!----><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"><!----></path><!----><!----><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"><!----></path><!----><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!----> <!--[!--><!--]--></button> <a href="#invalid-preflight-options-response---308-redirect" class="heading-link svelte-1j9ilu2"><!---->Invalid preflight OPTIONS response - 308 Redirect<!----><!----></a><!----></h3><!----><!----> <p>I ran into this issue with both API calls and CORS requests for static assets. It was particularly difficult to debug because it only occurred when making requests against my production deployment; development and staging environments worked fine with no issues.</p> <p>After an hour of detective work, I realized that <code>http://localhost:5173/selection.js</code> and <code>https://some-deployment-string.vercel.app/selection.js</code> both worked and <code>https://penguinsight.com/selection.js</code> because of how I had configured my domains in Vercel (my hosting provider). I have <code>https://penguinsight.com</code> configured to redirect to <code>https://www.penguinsight.com</code> (with a <code>www.</code>).</p> <p>I had two options to fix this:</p> <ol><li>Use <code>www.penguinsight.com</code> URIs in all my CORS requests</li> <li>Set <code>https://penguinsight.com</code> as the production domain instead</li></ol> <p>I opted for option 1 as it provides some extra flexibility for certain technical decisions in the future.</p> <!----><h2 id="addendum" class="heading-wrapper svelte-1j9ilu2"><button class="link-icon svelte-1j9ilu2" aria-label="Copy link to heading"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-link"><!--[--><!----><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"><!----></path><!----><!----><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"><!----></path><!----><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!----> <!--[!--><!--]--></button> <a href="#addendum" class="heading-link svelte-1j9ilu2"><!---->Addendum<!----><!----></a><!----></h2><!----><!----> <p>If you need to support authenticated requests, requests with specific <code>Content-Type</code>, or other header information, there are some additional CORS headers you can add to allow them. Here‚Äôs an example of a more permissive set of CORS headers:</p> <!----><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" data-tsplay="https://typescriptlang.org/play/#code/KYDwDg9gTgLgBAYwgOwM7yVVAJYBDAE2CzgF44BvAKDjgHIBBBBYVVAWgGEUYoIAbdg378IAdy5RgRZDACWefqjoAuerwCuwOgBoa9JizZcefQcNESA8lDkBzOclX0AVLv2NmrDt1lmhIuLsALLAMAAWEATKanRWAAoAKgCSVgByAMo68VYZiToA4gCi+fEAqqUMiZzYOgAiRQAyJUXutJ5GPqYCAZbsuITEMfrteBoR0HIAXnjyKDpwIOwI-HLAsuyOAGYQC3hgcgDWwACeCwAaXBkASgBi7IkQx8gX7NfAAI5a6NLsAOpyCILQzAMAwYFeMHsABqQzk8zgvhg6xg7Ea6zsQMRPBRITqAFYFkjcYkTmBgAs6rMKXBLgwDjC4Sg6FQAL4AbiAA"><code><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">export</span><span style="color:#AB5959;--shiki-dark:#CB7676"> const </span><span style="color:#B07D48;--shiki-dark:#BD976A">corsHeaders</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Credentials</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">true</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">*</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Methods</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">OPTIONS,POST,GET,PUT,PATCH,DELETE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Headers</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    '</span><span style="color:#B56959;--shiki-dark:#C98A7D">authorization, x-client-info, apikey, X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;;</span></span></code></pre><!----><!----><pre class="code-copy-target hidden">export const corsHeaders = &#123;
  'Access-Control-Allow-Credentials': 'true',
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Methods': 'OPTIONS,POST,GET,PUT,PATCH,DELETE',
  'Access-Control-Allow-Headers':
    'authorization, x-client-info, apikey, X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version'
&#125;;</pre><!----> <p>If any of those are not <em>needed</em> for your use case, I suggest not allowing them. Essentially these headers should be shrunk to the minimal set that works for your use case.</p><!----> <div><div id="twoslash-portal"></div><!----></div><!----><!----> <div class="divider svelte-12xwe57"></div> <aside class="prose dark:prose-invert svelte-12xwe57"><p class="svelte-12xwe57">If you're feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider svelte-12xwe57"></div></aside></article>  <!--[!--><!--]--> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous" class="svelte-12xwe57"/><!----><!----></div></div> <!--[!--><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_173f77 = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.WvV1SPpB.js"),
						import("../_app/immutable/entry/app.BT82jKLA.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>

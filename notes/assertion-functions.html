<!doctype html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.Db0SiVKR.css" rel="stylesheet">
		<link href="../_app/immutable/assets/NoteGridStatusFilter.CJR5s3-7.css" rel="stylesheet">
		<link href="../_app/immutable/assets/MDSveXNoteLayout.DSVYOmHN.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.D_43WCC9.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.wXNz-KYS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.DuayaxjO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.DG9R8YhD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.BfSw97s0.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.Jde4S1M6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.DXoakw9j.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.DU6y0MjB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/each.C67w4ChY.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/NoteGridStatusFilter.svelte_svelte_type_style_lang.BM_5toif.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DZoyX1z1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.QiGZPsKS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/NoteGrid.Dcz1HgOm.js"><title>TypeScript assertion functions increase type safety - Allan Deutsch</title><!-- HEAD_svelte-x3qw35_START --><meta name="description" content="Assertion functions let the programmer narrow types using a named function, making type narrowing much more readable."><meta property="og:title" content="TypeScript assertion functions increase type safety"><meta property="og:type" content="article"><meta property="og:url" content="https://allandeutsch.com/notes/assertion-functions"><meta property="og:description" content="Assertion functions let the programmer narrow types using a named function, making type narrowing much more readable."><meta property="og:locale" content="en_US"><meta property="twitter:card" content="summary"><meta property="twitter:url" content="https://allandeutsch.com"><meta property="twitter:title" content="TypeScript assertion functions increase type safety"><meta property="twitter:description" content="Assertion functions let the programmer narrow types using a named function, making type narrowing much more readable."><meta property="twitter:site" content="@AllanDeutsch"><meta property="twitter:creator" content="@AllanDeutsch"><link rel="canonical" href="https://allandeutsch.com/notes/assertion-functions"><script type="module" src="https://docduck.dev/selection.js" data-svelte-h="svelte-1qfon0b"></script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" data-svelte-h="svelte-bv2cpr"></script><!-- HEAD_svelte-x3qw35_END --><!-- HEAD_svelte-cpyj77_START -->   <meta name="theme-color" content="dark"><!-- HTML_TAG_START --><script nonce="%sveltekit.nonce%">(function setInitialMode(defaultMode, themeColors2) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem("mode-watcher-mode") || defaultMode;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  rootEl.classList[light ? "remove" : "add"]("dark");
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  localStorage.setItem("mode-watcher-mode", mode);
})("system", {"dark":"dark","light":"light"});</script><!-- HTML_TAG_END --><!-- HEAD_svelte-cpyj77_END -->
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
	</head>
	<body class="h-full min-h-[100vh] bg-base-100">
		<div style="display: contents">  <div class="h-full min-h-[100dvh]"><div class="toaster  svelte-jyff3d" role="alert"> </div> <div class="navbar bg-base-100 print:hidden"><div class="navbar-start"><div class="dropdown"><button tabindex="0" class="btn btn-ghost sm:hidden" data-svelte-h="svelte-o7egld"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg></button>  <ul tabindex="0" class="dropdown-content menu rounded-box menu-sm mt-3 w-52 bg-base-100 p-2 shadow"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li><li><a href="/devlog">Devlog</a></li></ul></div> <a class="btn btn-ghost text-xl normal-case" href="/">Allan Deutsch</a></div> <div class="navbar-center hidden sm:flex"><ul class="menu menu-horizontal px-1 text-base"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li><li><a href="/devlog">Devlog</a></li></ul></div> <div class="navbar-end"> <div class="h-8" data-svelte-h="svelte-1hosge2"><a href="https://twitter.com/AllanDeutsch" class="group"><svg height="24" width="24" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612"><path d="M612 116.258a250.714 250.714 0 01-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 01-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div> </div></div> <div class="h-full p-1 sm:p-4"> <docduck-feedback team="TKxfdiO22xOXIrW0c0Pfi"></docduck-feedback> <article class="note-container prose mb-8 max-w-full px-2 svelte-4qytck"><header class="w-full max-w-3xl self-center"><h1 class="mb-8 text-left text-4xl font-bold">TypeScript assertion functions increase type safety</h1> <div class="text-md mb-12 mt-4 flex justify-between border-t border-t-neutral border-opacity-20 pt-1 text-base-content"><div><span class="pr-2" data-svelte-h="svelte-114jejz">üå±</span><span class="hidden sm:inline" data-svelte-h="svelte-1psjisz">Planted
				</span>February 16, 2024.
				</div> <div class="flex flex-col items-end"><div class="note__status seedling svelte-4qytck">seedling üå±</div>  <div>2 minutes read ‚è±</div></div></div></header>  <p data-svelte-h="svelte-1d5e8gd">When working with union types, I often want to narrow the type to something specific. One way to do this is using <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#assertion-functions" rel="nofollow">assertion functions</a> which assert that after they‚Äôve been invoked, I can be certain that the type is what was asserted. The following assertion function will assert that a user is an admin:</p> <!-- HTML_TAG_START --><pre class="shiki shiki-themes vitesse-light vitesse-dark twoslash lsp" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]" data-tsplay="https://typescriptlang.org/play/#code/PTAEAEFMCdoe2gZwFygEwHYMFYBQkAPABwQBdRSBPIyUAVURlAF5QBvASwBNVFToOAOwDmAXwDc+YmQrVaAQS4BbIQyas10UADJ28ADaRUAIgCGyocYlSS0clRqgAcgiWn9mlvUZbdbA0agxgCuPlaSIKAAtDEAxsGkMVG4AGbBgrGkHHCCoKaIPqQAkoiKKoIAFKEwqC7Qbh4+oAA+oGWqPgCUqPmFiKDVWhz97YKebLgAkBwpFUHm5cagAITMrIMAdAGgnRQAFvAA7qCCkMcAorAIFSFNwydw5Ka5o8adkqK4kS5ZsbSke1opiuxzSGSyOVAiEoglIpgIoEB0EguFiOT4eQKMGKpQsgjQXiqPlqrncnlao003UxfQGdxGeM8zAAfOxcKBQDM5mY8UtVusfFs4IYdvsjiczqBLvBoDdBpz+oJHnkXrz3rhPql0plsrkFkIAPKCfSUIk1ZykxpMCmMroTDm9bElUZoM3QdWasE6yFcSCGUiQA3QYTPDgAL1MEMqg1QlJ8ABpQAgQ4Jw5HdUUeFD+EJhJ17aBIhtixrcFrwbq8qQA0oiKQACJ+yABoMptNRt0k+pkpo28qaRPJ0MRqOZ3g5kT5qaOuzOvFu9WTX3+wPB4fpnJuwdr1MjjNcReRDnHk+njkAPQA-BqgA"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> assertIsAdmin</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">	if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !==</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">role</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></code></span>role</span></span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#1E754F;--shiki-dark:#4D9375"> throw</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Error</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorConstructor</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">message</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> options</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorOptions</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#59873A;--shiki-dark:#80A665"> Error</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre></code></span>Error</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user is not an Admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// Notice the arrow function syntax here</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">const </span><span style="color:#59873A;--shiki-dark:#80A665">assertIsAdmin2</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">) => asserts </span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin2</span></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#AB5959;--shiki-dark:#CB7676"> is </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">  if</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !== </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">role</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></code></span>role</span></span><span style="color:#999999;--shiki-dark:#666666"> )</span><span style="color:#1E754F;--shiki-dark:#4D9375"> throw</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">var </span><span style="color:#B07D48;--shiki-dark:#BD976A">Error</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorConstructor</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">new</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#B07D48;--shiki-dark:#BD976A">message</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> options</span><span style="color:#AB5959;--shiki-dark:#CB7676">?</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">ErrorOptions</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#59873A;--shiki-dark:#80A665"> Error</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#B07D48;--shiki-dark:#BD976A"> overload</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre></code></span>Error</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user is not an Admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> adminOnly</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>adminOnly</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">  </span><span class="twoslash-error"><span style="color:#59873A;--shiki-dark:#80A665">assertIsAdmin2</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span><div class="twoslash-meta-line twoslash-error-line">Assertions require every name in the call target to be declared with an explicit type annotation.</div><span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> deleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>deleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">  // ...</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> </span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> attemptDeleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>attemptDeleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">user</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>NormalUser</span></span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0" ts twoslash highlight="[object Object]"><code><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> User</span><span style="color:#999999;--shiki-dark:#666666"> &#x26;</span><span style="color:#999999;--shiki-dark:#666666"> &#123;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">    role</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">admin</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre></code></span>AdminUser</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">)&#123;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> assertIsAdmin</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">NormalUser</span><span style="color:#999999;--shiki-dark:#666666"> | </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#999999;--shiki-dark:#666666"> asserts</span><span style="color:#B07D48;--shiki-dark:#BD976A"> user</span><span style="color:#AB5959;--shiki-dark:#CB7676"> is</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> AdminUser</span></code></span>assertIsAdmin</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> NormalUser</span><span style="color:#AB5959;--shiki-dark:#CB7676"> |</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">	</span><span style="color:#59873A;--shiki-dark:#80A665"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> deleteOrganization</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">user</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">AdminUser</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> organizationId</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">):</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> void</span></code></span>deleteOrganization</span></span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover twoslash-query-presisted"><span class="twoslash-popup-container"><div class="twoslash-popup-arrow"></div><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">user</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> AdminUser</span></code></span>user</span></span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> </span><span style="color:#B07D48;--shiki-dark:#BD976A"><span class="twoslash-hover"><span class="twoslash-popup-container"><code class="twoslash-popup-code"><span style="color:#59873A;--shiki-dark:#80A665">organizationId</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B07D48;--shiki-dark:#BD976A"> string</span></code></span>organizationId</span></span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#125;</span></span></code></pre><!-- HTML_TAG_END --><!-- HTML_TAG_START --><pre class="code-copy-target hidden">// @errors: 2775
export type User = &#123;id: string&#125;;
export type AdminUser = User & &#123;role: "admin"&#125;;
export type NormalUser = User & &#123;role: "user"&#125;;
// ---cut---
function assertIsAdmin(user: NormalUser | AdminUser): asserts user is AdminUser &#123;
	if( "admin" !== user.role ) throw new Error("user is not an Admin");
&#125;
// Notice the arrow function syntax here
const assertIsAdmin2 = (user: NormalUser | AdminUser): asserts user is AdminUser =&gt; &#123;
  if( "admin" !== user.role ) throw new Error("user is not an Admin");
&#125;

function adminOnly(user: NormalUser | AdminUser)&#123;
  assertIsAdmin2(user);
&#125;

function deleteOrganization(user: AdminUser, organizationId: string)&#123;
  // ...
&#125;

function attemptDeleteOrganization(user: NormalUser | AdminUser, organizationId: string)&#123;
	assertIsAdmin(user);
	deleteOrganization(user, organizationId);
	//                 ^?
&#125;</pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1ju18a3"><code>assertIsAdmin</code> <em>asserts</em> that the <code>user</code> is an <code>AdminUser</code>. There are a couple things to note here:</p> <ol data-svelte-h="svelte-qpynp2"><li>The <code>function</code> keyword is required. Notice that using <code>assertIsAdmin2</code>, the version with an arrow function, causes an error. This is because of an implementation detail of the compiler; <a href="https://github.com/microsoft/TypeScript/issues/56147#issuecomment-1768592995" rel="nofollow">the control flow graph is computed <em>before</em> type inferencing</a>.</li> <li>Any code that sits below a call to <code>assertIsAdmin</code> will have the type of <code>user</code> narrowed to <code>AdminUser</code>.</li></ol> <p data-svelte-h="svelte-yzj8hx">In <code>attemptDeleteOrganization</code>, you can see that after the call to <code>assertIsAdmin</code>, the <code>user</code>‚Äôs type is narrowed to <code>AdminUser</code>.</p> <div class="divider"></div> <aside class="prose" data-svelte-h="svelte-1w3uusp"> <p>If you&#39;re feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider"></div></aside></article>     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"></div></div>  
			
			<script>
				{
					__sveltekit_2hm6t8 = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.wXNz-KYS.js"),
						import("../_app/immutable/entry/app.Jde4S1M6.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>

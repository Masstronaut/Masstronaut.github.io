<!DOCTYPE html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.2fa4ea1c.css" rel="stylesheet">
		<link href="../_app/immutable/assets/LoadNote.144730f5.css" rel="stylesheet">
		<link href="../_app/immutable/assets/MDSveXNoteLayout.61812917.css" rel="stylesheet">
		<link href="../_app/immutable/assets/6.8a973cea.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.28cab18a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.7131e7f1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.6034482e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/paths.3658a978.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/parse.bee59afc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.c2cf8273.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.59773ae6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.a4192956.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.9e889c2d.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.d18c473c.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/each.49c20442.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/LoadNote.71b0233f.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/navigation.786d8864.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/toast.572f44f6.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/6.c136c15e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.a5def98b.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/NoteGrid.cd78f750.js"><title>devlog 6: routing overhaul - Allan Deutsch</title><!-- HEAD_svelte-x3qw35_START --><meta name="description" content="A major overhaul to routing on this site! Plus TS identity functions, reference sheets, and my resume!"><meta property="og:title" content="devlog 6: routing overhaul"><meta property="og:type" content="article"><meta property="og:url" content="https://allandeutsch.com/devlog/6"><meta property="og:description" content="A major overhaul to routing on this site! Plus TS identity functions, reference sheets, and my resume!"><meta property="og:locale" content="en_US"><meta property="twitter:card" content="summary"><meta property="twitter:url" content="https://allandeutsch.com"><meta property="twitter:title" content="devlog 6: routing overhaul"><meta property="twitter:description" content="A major overhaul to routing on this site! Plus TS identity functions, reference sheets, and my resume!"><meta property="twitter:site" content="@AllanDeutsch"><meta property="twitter:creator" content="@AllanDeutsch"><link rel="canonical" href="https://allandeutsch.com/devlog/6"><script type="module" src="https://docduck.dev/selection.js" data-svelte-h="svelte-1qfon0b"></script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AllanDeutsch" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18" data-svelte-h="svelte-bv2cpr"></script><!-- HEAD_svelte-x3qw35_END --><!-- HEAD_svelte-cpyj77_START -->   <meta name="theme-color" content="dark"><!-- HTML_TAG_START --><script nonce="%sveltekit.nonce%">(function setInitialMode(defaultMode, themeColors2) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem("mode-watcher-mode") || defaultMode;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  rootEl.classList[light ? "remove" : "add"]("dark");
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  localStorage.setItem("mode-watcher-mode", mode);
})("system", {"dark":"dark","light":"light"});</script><!-- HTML_TAG_END --><!-- HEAD_svelte-cpyj77_END -->
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-86124920-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'UA-86124920-1');
		</script>
	</head>
	<body class="h-full min-h-[100vh] bg-base-100">
		<div style="display: contents">  <div class="h-full min-h-[100dvh]"><div class="toaster  svelte-jyff3d"> </div> <div class="navbar bg-base-100 print:hidden"><div class="navbar-start"><div class="dropdown"><button tabindex="0" class="btn btn-ghost sm:hidden" data-svelte-h="svelte-o7egld"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path></svg></button> <ul tabindex="0" class="dropdown-content menu rounded-box menu-sm mt-3 w-52 bg-base-100 p-2 shadow"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li><li><a href="/devlog">Devlog</a></li></ul></div> <a class="btn btn-ghost text-xl normal-case" href="/">Allan Deutsch</a></div> <div class="navbar-center hidden sm:flex"><ul class="menu menu-horizontal px-1 text-base"><li><a href="/">Home</a></li><li><a href="/notes">Notes</a></li><li><a href="/devlog">Devlog</a></li></ul></div> <div class="navbar-end"> <div class="h-8" data-svelte-h="svelte-1hosge2"><a href="https://twitter.com/AllanDeutsch" class="group"><svg height="24" width="24" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612"><path d="M612 116.258a250.714 250.714 0 01-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 01-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a> <a href="https://github.com/masstronaut" class="group"><svg height="24" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="mr-1.5 inline fill-base-content transition-colors duration-300 group-hover:fill-primary"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></div> </div></div> <div class="h-full p-1 sm:p-4"> <docduck-feedback team="TKxfdiO22xOXIrW0c0Pfi"></docduck-feedback> <article class="note-container prose mb-8 max-w-full px-2 svelte-1w2p8sa"><header class="w-full max-w-3xl self-center"><h1 class="mb-8 text-left text-4xl font-bold">devlog 6: routing overhaul</h1> <div class="text-md mb-12 mt-4 flex justify-between border-t border-t-neutral border-opacity-20 pt-1 text-base-content"><div><span class="pr-2" data-svelte-h="svelte-114jejz">üå±</span><span class="hidden sm:inline" data-svelte-h="svelte-1psjisz">Planted
				</span>May 15, 2024.
				<br>Last tended May 19, 2024.</div> <div class="flex flex-col items-end"><div class="note__status seedling svelte-1w2p8sa">seedling üå±</div>  <div>7 minutes read ‚è±</div></div></div></header>  <h2 id="allandeutschcom" data-svelte-h="svelte-1bdscsw"><a aria-hidden="true" tabindex="-1" href="#allandeutschcom"><span class="icon icon-link"></span></a><a href="#allandeutschcom" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Allandeutsch.com</h2> <h3 id="improving-how-markdown-based-pages-are-loaded" data-svelte-h="svelte-dl0qmp"><a aria-hidden="true" tabindex="-1" href="#improving-how-markdown-based-pages-are-loaded"><span class="icon icon-link"></span></a><a href="#improving-how-markdown-based-pages-are-loaded" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Improving how markdown-based pages are loaded</h3> <p data-svelte-h="svelte-1gojoy0">A design decision I made years ago has recently started to haunt me. The decision was to have every page from my notes served on the route <code>https://allandeutsch.com/notes/{slug}/</code>. For a long time this wasn‚Äôt an issue, but recently I started writing weekly <a href="https://allandeutsch.com/devlog/" rel="nofollow">dev logs</a> like the one you are reading now! Since my devlogs are a periodical publication, I wanted them to stand alone in a separate place - <code>/devlog/{id}</code>. That was incompatible with the existing approach to publishing where notes lived under <code>/notes/{slug}/</code>. For the first couple couple weeks I manually copied over the devlogs into my site repo and while that worked fine, it left things to be desired. I had to manually update all the links, and I ended up finding a variety of other workarounds were needed to use functionality I‚Äôd already built for notes. It was finally time to improve my publishing pipeline to support more configurable page routes!</p> <p data-svelte-h="svelte-1od704r">Now I can set a note‚Äôs slug to a nested route, such as <code>devlog/6</code> (this page!) and it goes through the normal note publishing pipeline with all my shiny features and gets published on the right URL! I also cleaned up the server code for getting from the slug of a requested page to the markdown file with its content. What used to be a brittle and buggy process has been smooth and reliable since the change went live.  Before I was loading up all the notes when the server started. That caused me headaches in a number of ways:</p> <ol data-svelte-h="svelte-14twctw"><li>If I updated a note after launching the dev server, I had to restart the server to render the new content. ick!</li> <li>My CICD pipeline recently started to ran out of RAM eagerly loading all my notes. I switched to a more serial approach to loading which fixed this.</li></ol> <p data-svelte-h="svelte-1ezmckm">The new approach will reload notes on request/change, which has been a much nicer dev experience for me. This has been great as I‚Äôve been playing with some more advanced <a href="https://shiki.style/packages/twoslash#rendererrich" rel="nofollow">twoslash</a> features, like in <a href="/notes/identity-functions#providing-type-hints-to-api-consumers">Identity functions &gt; Providing type hints to API consumers</a>, where I show intellisense completion suggestions.</p> <p data-svelte-h="svelte-1iphfs7">It took a couple days getting all my note routing changes up and running, but I‚Äôm thrilled I did. One giant leap towards open-sourcing the site code!</p> <h3 id="flexbox-reference-sheet" data-svelte-h="svelte-j2hqsq"><a aria-hidden="true" tabindex="-1" href="#flexbox-reference-sheet"><span class="icon icon-link"></span></a><a href="#flexbox-reference-sheet" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flexbox reference sheet</h3> <p data-svelte-h="svelte-1pfvdrd">James and I built our own versions of the <a href="https://flexbox.malven.co" rel="nofollow">malven flexbox reference</a>. I had fun making <a href="https://allandeutsch.com/projects/flex/" rel="nofollow">a Tailwind version</a> and it was refreshing to work on a small project that is done at the end of the day. It was also a great first project for James, who set up a new remix project, added Tailwind to it, and got a ton of practice in arranging boxes.</p> <p data-svelte-h="svelte-gs0byk">A few years ago I started building my resume as a basic HTML web document and it‚Äôs been much better than a word doc. This week I moved it from a standalone project into my website, and now the web version of <a href="https://allandeutsch.com/resume/" rel="nofollow">my resume is on allandeutsch.com/resume</a>. I also updated the styles so it stays readable on mobile. Much easier to share a link to it now!</p> <h2 id="total-typescript" data-svelte-h="svelte-1bwwahh"><a aria-hidden="true" tabindex="-1" href="#total-typescript"><span class="icon icon-link"></span></a><a href="#total-typescript" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Total TypeScript</h2> <p data-svelte-h="svelte-9f5k7b">This week I finished the unit on <a href="/notes/identity-functions">identity functions</a>. I find the way they are used to coerce the TypeScript compiler to infer more specific types is fascinating. The technique manifests in a variety of ways, and they are often behind the scenes of great TypeScript APIs.</p> <p data-svelte-h="svelte-1njo641">I found <a href="/notes/total-typescript-notes#reverse-mapped-types">reverse mapped types</a> to be particularly fascinating.</p> <h2 id="doc-duck" data-svelte-h="svelte-12rebzx"><a aria-hidden="true" tabindex="-1" href="#doc-duck"><span class="icon icon-link"></span></a><a href="#doc-duck" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Doc Duck</h2> <p data-svelte-h="svelte-6u5bk8">This week I found out that I wasn‚Äôt accepted to the PMF program with first round. While I was really excited about it and moving to SF for a few months, I slowly realized it was going to be pretty painful. I had something I <em>really</em> want to be in Seattle for every couple weeks for June through mid-July, which would‚Äôve really detracted from my SF experience. Plus missing the Seattle Summer would‚Äôve been a real bummer. I‚Äôll set my sights on landing some customers on my own and shooting for an SF accelerator in Fall/Winter, which should line up well with when I need to extend my runway.</p> <p data-svelte-h="svelte-u1ooib">I also talked to my friend Vritant, who works on the VS Code education team. He made the excellent observation that Doc Duck would be very helpful for other types of web-based documents, not just <em>product</em> docs. He works on building an in-editor curriculum for teaching programming, and it would be helpful if students could send their feedback from right in the editor.</p> <p data-svelte-h="svelte-ztmu4p">Similarly, I think Doc Duck could be helpful for other courses. The web development courses I‚Äôve done recently are all custom web software, which could be great candidates:</p> <ul data-svelte-h="svelte-1m86m7b"><li>Josh W Comeau‚Äôs <a href>CSS for JS devs</a></li> <li>Kent C Dodd‚Äôs <a href="https://epicweb.dev" rel="nofollow">Epic Web Dev</a></li> <li>Matt Pocock‚Äôs <a href="https://www.totaltypescript.com/" rel="nofollow">Total TypeScript</a></li></ul> <div class="divider"></div> <aside class="prose" data-svelte-h="svelte-1w3uusp"> <p>If you&#39;re feeling extra generous, you can show your support by buying me a
			coffee with the button in the bottom right corner of the page.</p> <div class="divider"></div></aside></article>   <div class="flex w-full flex-col items-center"><h2 class="my-6 self-center text-5xl text-base-content">Linked notes</h2>  <div class="col-auto grid w-full grid-cols-[repeat(auto-fill,_minmax(300px,_1fr))] justify-items-center gap-3"><a href="/notes/identity-functions" class="m-4 flex w-full min-w-[300px] max-w-[450px] flex-1 basis-80 text-inherit no-underline" style="--statusColor: 85, 40%, 55%;"><article class="group flex h-64 w-full flex-col justify-between border border-solid border-base-300 bg-base-100 px-10 py-8 text-base-content text-opacity-80 transition-all duration-200 hover:border-[hsl(var(--statusColor))] hover:text-opacity-100 hover:shadow-xl hover:shadow-[hsla(var(--statusColor),.25)] active:-translate-y-1 active:scale-[1.01] active:shadow-md  svelte-1xtqadk"><section class="notecontent"><header class="svelte-1xtqadk"><h1 class="line-clamp-2 h-16 text-lg leading-[175%] svelte-1xtqadk">Identity functions</h1></header> <p class="mt-3 line-clamp-3 h-[4.5em] leading-[1.5em] transition-all duration-200">Identity functions make it possible to provide a much better developer experience at API boundaries by improving the type</p></section> <section class="notemetadata border-t border-t-neutral-content border-opacity-60 pt-1 text-right text-sm svelte-1xtqadk"><div class="date min-w-[12ch] text-opacity-50 svelte-1xtqadk">May 19, 2024</div> <div class="min-w-[12ch] capitalize text-[hsl(var(--statusColor))] svelte-1xtqadk">seedling üå±</div></section></article> </a></div></div>  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"></div></div>  
			
			<script>
				{
					__sveltekit_cz81ct = {
						base: new URL("..", location).pathname.slice(0, -1),
						env: {"PUBLIC_SUPABASE_ANON_KEY":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFlb3ZmZXRyaXNyZnFpZWF0bXp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODcwNjM0NTYsImV4cCI6MjAwMjYzOTQ1Nn0.s9KXOQ0gDdl7e3lTUxdN5yfPI0rLZ-dSRMfEwoHhK00","PUBLIC_SUPABASE_URL":"https://aeovfetrisrfqieatmzw.supabase.co"}
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":{session:null,user:null},"uses":{}},null];

					Promise.all([
						import("../_app/immutable/entry/start.28cab18a.js"),
						import("../_app/immutable/entry/app.59773ae6.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 6],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
